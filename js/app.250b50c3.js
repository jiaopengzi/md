(function(e){function t(t){for(var n,s,a=t[0],l=t[1],c=t[2],u=0,m=[];u<a.length;u++)s=a[u],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&m.push(r[s][0]),r[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);d&&d(t);while(m.length)m.shift()();return i.push.apply(i,c||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],n=!0,a=1;a<o.length;a++){var l=o[a];0!==r[l]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=o[0]))}return e}var n={},r={app:0},i=[];function s(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=e,s.c=n,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(o,n,function(t){return e[t]}.bind(null,n));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/md/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var d=l;i.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"0a46":function(e,t,o){"use strict";o("9436")},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},2:function(e,t){},"220e":function(e,t,o){},"2aa0":function(e,t,o){},3:function(e,t){},"3f50":function(e,t,o){},"3f5e":function(module,__webpack_exports__,__webpack_require__){"use strict";var _fetch__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("e1d2"),_config__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("da71"),crypto_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("3452"),crypto_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(crypto_js__WEBPACK_IMPORTED_MODULE_2__),ali_oss__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("9b15"),ali_oss__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(ali_oss__WEBPACK_IMPORTED_MODULE_3__),minio__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("ad23"),minio__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(minio__WEBPACK_IMPORTED_MODULE_4__),cos_js_sdk_v5__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("3438"),cos_js_sdk_v5__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(cos_js_sdk_v5__WEBPACK_IMPORTED_MODULE_5__),buffer_from__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("653c"),buffer_from__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(buffer_from__WEBPACK_IMPORTED_MODULE_6__),uuid__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("ec26"),qiniu_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("f744"),_assets_scripts_tokenTools__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("4e00");function getConfig(e,t){if(e){const e="github"===t?_config__WEBPACK_IMPORTED_MODULE_1__["b"]:_config__WEBPACK_IMPORTED_MODULE_1__["a"],{username:o,repoList:n,branch:r,accessTokenList:i}=e,s=Math.floor(Math.random()*i.length),a=i[s].replace("jpzmd",""),l=Math.floor(Math.random()*n.length),c=n[l];return{username:o,repo:c,branch:r,accessToken:a}}const o=JSON.parse(localStorage.getItem(t+"Config")),n=o.repo.replace(`https://${t}.com/`,"").replace(`http://${t}.com/`,"").replace(t+".com/","").split("/");return{username:n[0],repo:n[1],branch:o.branch||"master",accessToken:o.accessToken}}function getDir(){const e=new Date,t=e.getFullYear(),o=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0");return`${t}/${o}/${n}`}function getDateFilename(e){const t=(new Date).getTime(),o=e.split(".")[1];return`${t}-${Object(uuid__WEBPACK_IMPORTED_MODULE_7__["a"])()}.${o}`}async function ghFileUpload(e,t){var o;const n="default"===localStorage.getItem("imgHost"),{username:r,repo:i,branch:s,accessToken:a}=getConfig(n,"github"),l=getDir(),c=`https://api.github.com/repos/${r}/${i}/contents/${l}/`,d=getDateFilename(t),u=await Object(_fetch__WEBPACK_IMPORTED_MODULE_0__["a"])({url:c+d,method:"put",headers:{Authorization:"token "+a},data:{content:e,branch:s,message:"Upload by "+window.location.href}}),m=`raw.githubusercontent.com/${r}/${i}/${s}/`,p=`fastly.jsdelivr.net/gh/${r}/${i}@${s}/`;return u.content=(null===(o=u.data)||void 0===o?void 0:o.content)||u.content,n?u.content.download_url.replace(m,p):u.content.download_url}async function giteeUpload(e,t){var o;const n="default"===localStorage.getItem("imgHost"),{username:r,repo:i,branch:s,accessToken:a}=getConfig(n,"gitee"),l=getDir(),c=getDateFilename(t),d=`https://gitee.com/api/v5/repos/${r}/${i}/contents/${l}/${c}`,u=await Object(_fetch__WEBPACK_IMPORTED_MODULE_0__["a"])({url:d,method:"POST",data:{content:e,branch:s,access_token:a,message:"Upload by "+window.location.href}});return u.content=(null===(o=u.data)||void 0===o?void 0:o.content)||u.content,encodeURI(u.content.download_url)}function getQiniuToken(e,t,o){const n=JSON.stringify(o),r=Object(_assets_scripts_tokenTools__WEBPACK_IMPORTED_MODULE_9__["base64encode"])(Object(_assets_scripts_tokenTools__WEBPACK_IMPORTED_MODULE_9__["utf16to8"])(n)),i=crypto_js__WEBPACK_IMPORTED_MODULE_2___default.a.HmacSHA1(r,t),s=i.toString(crypto_js__WEBPACK_IMPORTED_MODULE_2___default.a.enc.Base64);return`${e}:${Object(_assets_scripts_tokenTools__WEBPACK_IMPORTED_MODULE_9__["safe64"])(s)}:${r}`}async function qiniuUpload(e){const{accessKey:t,secretKey:o,bucket:n,region:r,path:i,domain:s}=JSON.parse(localStorage.getItem("qiniuConfig")),a=getQiniuToken(t,o,{scope:n,deadline:Math.trunc((new Date).getTime()/1e3)+3600}),l=i?i+"/":"",c=l+getDateFilename(e.name),d=qiniu_js__WEBPACK_IMPORTED_MODULE_8__["upload"](e,c,a,{},{region:r});return new Promise((e,t)=>{d.subscribe({next:e=>{console.log(e)},error:e=>{t(e.message)},complete:t=>{e(`${s}/${t.key}`)}})})}async function aliOSSFileUpload(e,t){const o=getDateFilename(t),{region:n,bucket:r,accessKeyId:i,accessKeySecret:s,cdnHost:a,path:l}=JSON.parse(localStorage.getItem("aliOSSConfig")),c=buffer_from__WEBPACK_IMPORTED_MODULE_6___default()(e,"base64"),d=`${l}/${o}`,u=new ali_oss__WEBPACK_IMPORTED_MODULE_3___default.a({region:n,bucket:r,accessKeyId:i,accessKeySecret:s});try{const e=await u.put(d,c);return""===a?e.url:`${a}/${""===l?o:d}`}catch(m){return Promise.reject(m)}}async function txCOSFileUpload(e){const t=getDateFilename(e.name),{secretId:o,secretKey:n,bucket:r,region:i,path:s,cdnHost:a}=JSON.parse(localStorage.getItem("txCOSConfig")),l=new cos_js_sdk_v5__WEBPACK_IMPORTED_MODULE_5___default.a({SecretId:o,SecretKey:n});return new Promise((o,n)=>{l.putObject({Bucket:r,Region:i,Key:`${s}/${t}`,Body:e},(function(e,r){e?n(e):o(a?""==s?`${a}/${t}`:`${a}/${s}/${t}`:"https://"+r.Location)}))})}async function minioFileUpload(e,t){const o=getDateFilename(t),{endpoint:n,port:r,useSSL:i,bucket:s,accessKey:a,secretKey:l}=JSON.parse(localStorage.getItem("minioConfig")),c=buffer_from__WEBPACK_IMPORTED_MODULE_6___default()(e,"base64"),d={endPoint:n,useSSL:i,accessKey:a,secretKey:l},u=Number(r||0),m=u>0&&80!==u&&443!==u;return m&&(d.port=u),new Promise((e,t)=>{const a=new minio__WEBPACK_IMPORTED_MODULE_4__["Client"](d);try{a.putObject(s,o,c,(function(a){a&&t(a);const l=`${i?"https://":"http://"}${n}${m?":"+r:""}`,c=`${l}/${s}/${o}`;e(c)}))}catch(l){t(l)}})}async function formCustomUpload(content,file){const str=`\n    async (CUSTOM_ARG) => {\n      ${localStorage.getItem("formCustomConfig")}\n    }\n  `;return new Promise((resolve,reject)=>{const exportObj={content:content,file:file,util:{axios:_fetch__WEBPACK_IMPORTED_MODULE_0__["a"],CryptoJS:crypto_js__WEBPACK_IMPORTED_MODULE_2___default(),OSS:ali_oss__WEBPACK_IMPORTED_MODULE_3___default(),COS:cos_js_sdk_v5__WEBPACK_IMPORTED_MODULE_5___default(),Buffer:buffer_from__WEBPACK_IMPORTED_MODULE_6___default(),uuidv4:uuid__WEBPACK_IMPORTED_MODULE_7__["a"],qiniu:qiniu_js__WEBPACK_IMPORTED_MODULE_8__,tokenTools:_assets_scripts_tokenTools__WEBPACK_IMPORTED_MODULE_9__,getDir:getDir,getDateFilename:getDateFilename},okCb:resolve,errCb:reject};eval(str)(exportObj).catch(e=>{console.error(e),reject(e)})})}function fileUpload(e,t){const o=localStorage.getItem("imgHost");switch(!o&&localStorage.setItem("imgHost","default"),o){case"aliOSS":return aliOSSFileUpload(e,t.name);case"minio":return minioFileUpload(e,t.name);case"txCOS":return txCOSFileUpload(t);case"qiniu":return qiniuUpload(t);case"gitee":return giteeUpload(e,t.name);case"github":return ghFileUpload(e,t.name);case"formCustom":return formCustomUpload(e,t);default:return ghFileUpload(e,t.name)}}__webpack_exports__["a"]={fileUpload:fileUpload}},4:function(e,t){},"4c2f":function(e,t,o){},"4e00":function(e,t,o){"use strict";function n(e){var t,o,n,r;for(t="",n=e.length,o=0;o<n;o++)r=e.charCodeAt(o),r>=1&&r<=127?t+=e.charAt(o):r>2047?(t+=String.fromCharCode(224|r>>12&15),t+=String.fromCharCode(128|r>>6&63),t+=String.fromCharCode(128|r>>0&63)):(t+=String.fromCharCode(192|r>>6&31),t+=String.fromCharCode(128|r>>0&63));return t}function r(e){var t,o,n,r,i,s;t="",n=e.length,o=0;while(o<n)switch(r=e.charCodeAt(o++),r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(o-1);break;case 12:case 13:i=e.charCodeAt(o++),t+=String.fromCharCode((31&r)<<6|63&i);break;case 14:i=e.charCodeAt(o++),s=e.charCodeAt(o++),t+=String.fromCharCode((15&r)<<12|(63&i)<<6|(63&s)<<0);break}return t}o.r(t),o.d(t,"utf16to8",(function(){return n})),o.d(t,"utf8to16",(function(){return r})),o.d(t,"base64encode",(function(){return a})),o.d(t,"base64decode",(function(){return l})),o.d(t,"safe64",(function(){return c}));const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",s=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function a(e){var t,o,n,r,s,a;n=e.length,o=0,t="";while(o<n){if(r=255&e.charCodeAt(o++),o==n){t+=i.charAt(r>>2),t+=i.charAt((3&r)<<4),t+="==";break}if(s=e.charCodeAt(o++),o==n){t+=i.charAt(r>>2),t+=i.charAt((3&r)<<4|(240&s)>>4),t+=i.charAt((15&s)<<2),t+="=";break}a=e.charCodeAt(o++),t+=i.charAt(r>>2),t+=i.charAt((3&r)<<4|(240&s)>>4),t+=i.charAt((15&s)<<2|(192&a)>>6),t+=i.charAt(63&a)}return t}function l(e){var t,o,n,r,i,a,l;a=e.length,i=0,l="";while(i<a){do{t=s[255&e.charCodeAt(i++)]}while(i<a&&-1==t);if(-1==t)break;do{o=s[255&e.charCodeAt(i++)]}while(i<a&&-1==o);if(-1==o)break;l+=String.fromCharCode(t<<2|(48&o)>>4);do{if(n=255&e.charCodeAt(i++),61==n)return l;n=s[n]}while(i<a&&-1==n);if(-1==n)break;l+=String.fromCharCode((15&o)<<4|(60&n)>>2);do{if(r=255&e.charCodeAt(i++),61==r)return l;r=s[r]}while(i<a&&-1==r);if(-1==r)break;l+=String.fromCharCode((3&n)<<6|r)}return l}function c(e){return e=e.replace(/\+/g,"-"),e=e.replace(/\//g,"_"),e}},"4ff8":function(e,t,o){},5:function(e,t){},5609:function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);var n=o("2b0e"),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},i=[],s=(o("fd13"),o("f4a0"),o("2877")),a={},l=Object(s["a"])(a,r,i,!1,null,null,null),c=l.exports,d=o("2f62"),u=(o("81e8"),{builtinFonts:[{label:"无衬线",value:"-apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif",desc:"Abc"},{label:"衬线",value:"Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, 'PingFang SC', Cambria, Cochin, Georgia, Times, 'Times New Roman', serif",desc:"Abc"}],sizeOption:[{label:"12px",value:"12px",desc:"更小"},{label:"13px",value:"13px",desc:"稍小"},{label:"14px",value:"14px",desc:"推荐"},{label:"15px",value:"15px",desc:"稍大"},{label:"16px",value:"16px",desc:"更大"}],colorOption:[{label:"焦棚子",value:"rgba(30, 47, 86, 1)",desc:"焦棚子"},{label:"经典蓝",value:"rgba(15, 76, 129, 1)",desc:"最新流行"},{label:"翡翠绿",value:"rgba(0, 152, 116, 1)",desc:"优雅清新"},{label:"活力橘",value:"rgba(250, 81, 81, 1)",desc:"热情活泼"}],codeThemeOption:[{label:"焦棚子",value:"./highlight.js.jpz.css",desc:"dark"},{label:"github",value:"https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/npm/highlight.js@11.5.1/styles/github.min.css",desc:"light"},{label:"solarized-light",value:"https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/npm/highlight.js@11.5.1/styles/solarized-light.min.css",desc:"light"},{label:"atom-one-dark",value:"https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/npm/highlight.js@11.5.1/styles/atom-one-dark.min.css",desc:"dark"},{label:"obsidian",value:"https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/npm/highlight.js@11.5.1/styles/obsidian.min.css",desc:"dark"},{label:"vs2015",value:"https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/npm/highlight.js@11.5.1/styles/vs2015.min.css",desc:"dark"}],form:{rows:1,cols:1}}),m=(o("5b81"),o("7c5c")),p=o("1487"),f=o.n(p);class h{constructor(e){this.opts=e;let t=[],o=0,n=new Map,r=(e,t)=>Object.assign({},e,t);this.buildTheme=e=>{let t={},o=r(e.BASE,{"font-family":this.opts.fonts,"font-size":this.opts.size});for(let i in e.inline)if(e.inline.hasOwnProperty(i)){let o=e.inline[i];t[i]=r(e.BASE,o)}let n=r(o,{});for(let i in e.block)if(e.block.hasOwnProperty(i)){let o=e.block[i];t[i]=r(n,o)}return t};let i=(e,t)=>{let o=[],r=n[e];if(!r)return"";for(const n in r)o.push(n+":"+r[n]);return`style="${o.join(";")+(t||"")}"`};this.buildFootnotes=()=>{let e=t.map(e=>e[1]===e[2]?`<code style="font-size: 90%; opacity: 0.6;">[${e[0]}]</code>: <i>${e[1]}</i><br/>`:`<code style="font-size: 90%; opacity: 0.6;">[${e[0]}]</code> ${e[1]}: <i>${e[2]}</i><br/>`);return e.length?`<h4 ${i("h4")}>引用链接</h4><p ${i("footnotes")}>${e.join("\n")}</p>`:""},this.buildAddition=()=>"\n            <style>\n            .preview-wrapper pre::before {\n                position: absolute;\n                top: 0;\n                right: 0;\n                color: #ccc;\n                text-align: center;\n                font-size: 0.8em;\n                padding: 5px 10px 0;\n                line-height: 15px;\n                height: 15px;\n                font-weight: 600;\n            }\n            </style>\n        ",this.setOptions=e=>{this.opts=r(this.opts,e)},this.hasFootnotes=()=>0!==t.length,this.getRenderer=e=>{t=[],o=0,n=this.buildTheme(this.opts.theme);let r=new m["Renderer"];return r.heading=(e,t)=>{switch(t){case 1:return`<h1 ${i("h1")}>${e}</h1>`;case 2:return`<h2 ${i("h2")}>${e}</h2>`;case 3:return`<h3 ${i("h3")}>${e}</h3>`;default:return`<h4 ${i("h4")}>${e}</h4>`}},r.paragraph=e=>-1!=e.indexOf("<figure")&&-1!=e.indexOf("<img")?e:""===e.replace(/ /g,"")?"":`<p ${i("p")}>${e}</p>`,r.blockquote=e=>(e=e.replace(/<p.*?>/g,`<p ${i("blockquote_p")}>`),`<blockquote ${i("blockquote")}>${e}</blockquote>`),r.code=(e,t)=>{t=f.a.getLanguage(t)?t:"plaintext",e=f.a.highlight(e,{language:t}).value;const o=/<span class="hljs-variable">(.*?)<\/span>/gs,n=e.match(o);null!=n&&n.forEach(t=>{const o=t.replace(/<span class="hljs-variable">/g," ").replace(/<\/span>/g,""),n=['<span class="hljs-variable">',o,"</span>"].join("");e=e.replaceAll(o,n)});const r=/<span class="hljs-comment">(.*?)<\/span>/gs,i=e.match(r);null!=i&&i.forEach(t=>{const o=t.replace(/\r\n/g,'</span></code><code><span class="hljs-comment">').replace(/\n/g,'</span></code><code><span class="hljs-comment">');e=e.replace(t,o)});const s=/<span class="hljs-string">(.*?)<\/span>/gs,a=e.match(s);return null!=a&&a.forEach(t=>{const o=t.replace(/\r\n/g,'</span></code><code><span class="hljs-string">').replace(/\n/g,'</span></code><code><span class="hljs-string">');e=e.replace(t,o)}),e=e.replace(/\r\n/g,"</code><code>").replace(/\n/g,"</code><code>").replace(/(>[^<]+)|(^[^<]+)/g,(function(e){return e.replace(/\s/g,"&nbsp;")})),`<pre class="code-snippet__js hljs code__pre"><code class="prettyprint language-${t}">${e}</code></pre>`},r.codespan=(e,t)=>`<code ${i("codespan")}>${e}</code>`,r.listitem=e=>`<li ${i("listitem")}><span><%s/></span>${e}</li>`,r.list=(e,t,o)=>{e=e.replace(/<\/*p.*?>/g,"");let n=e.split("<%s/>");if(!t)return e=n.join("• "),`<ul ${i("ul")}>${e}</ul>`;e=n[0];for(let r=1;r<n.length;r++)e=e+r+". "+n[r];return`<ol ${i("ol")}>${e}</ol>`},r.image=(e,t,o)=>{let n="";o&&(n=`<figcaption ${i("figcaption")}>${o}</figcaption>`);let r=i("figure"),s=i("image");return`<figure ${r}><img ${s} src="${e}" title="${t}" alt="${o}"/>${n}</figure>`},r.link=(e,t,o)=>e.startsWith("https://mp.weixin.qq.com")?`<a href="${e}" title="${t||o}" ${i("wx_link")}>${o}</a>`:e===o?`<span class="hljs-link">${e}</span>`:`<span class="hljs-link-text">${o}</span><span class="hljs-link">(${e})</span>`,r.strong=e=>`<strong ${i("strong")}>${e}</strong>`,r.em=e=>`<span style="font-style: italic;">${e}</span>`,r.table=(e,t)=>`<section style="padding:0 8px;"><table class="preview-table"><thead ${i("thead")}>${e}</thead><tbody>${t}</tbody></table></section>`,r.tablecell=(e,t)=>`<td ${i("td")}>${e}</td>`,r.hr=()=>`<hr ${i("hr")}>`,r}}}var g=h,_=o("56b3"),b=o.n(_),C="# 159\\_模型\\_Power BI 地理分析之形状地图\r\n\r\n**声明以下地图元素仅供学习交流所用，如需地图公开使用请提前做好报审工作。**\r\n\r\n## 一、背景\r\n\r\n当企业的体量达到一定体量的时候，保持稳定的增长是非常重要的事情。本案例展示如何用 Power BI 的形状地图来寻求业务的增长。\r\n\r\n我们先来看结论：\r\n\r\n- 省级市场共计：34 个，已开拓：34 个；占比：100.0%。\r\n\r\n- 地市级市场共计：370 个，已开拓：214 个；占比：57.8%。\r\n\r\n- 区县级市场共计：2875 个，已开拓：356 个；占比：12.4%。\r\n\r\n其实从这个三条结论来看，市场层级越下沉，其实我们的空白市场越多；当然要业务能支撑这样的规模才行。\r\n\r\n通过三张图，就让各大区领着各自团队回去开会，制定一个空白市场开发的计划及相应的配套预算。\r\n\r\n\r\n\r\n\r\nPower BI 公共 web 效果：https://demo.jiaopengzi.com/pbi/159-full.html\r\n\r\n\r\n\r\n![159-1](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-1.png)\r\n\r\n![159-2](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-2.png)\r\n\r\n![159-3](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-3.png)\r\n\r\n\r\n\r\n## 二、模型设计\r\n\r\n### 1、地图数据\r\n\r\n要分析从 省份>地市>区县 三个层级的地理业务数据，首先要准备的是 省份、地市、区县 三个层级的地理数据。\r\n\r\n数据获取可以从阿里云的 DataV.GeoAtlas（https://datav.aliyun.com/portal/school/atlas/area_selector） 获取。\r\n\r\n![159-4](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-4.png)\r\n\r\n\r\n\r\n简单的数据获取直接从这里获取即可，但是我们需要的 省份、地市、区县 三级的数据，那么我们就是用 Python 获取这部分数据。\r\n\r\n数据拿到以后还要做相应的清洗，清洗不必要的字段信息；这里获取的数据是 GeoJSON 格式；但是 Power BI 的形状地图（https://docs.microsoft.com/zh-cn/power-bi/visuals/desktop-shape-map）需要使用的是 TopoJSON 格式数据。\r\n\r\nGeoJSON 转换为  TopoJSON 我们使用开源的工具 mapshaper (https://github.com/mbloch/mapshaper) 转换即可。数量不是特别多的话可以使用可视化的方式转换将 GeoJson 格式数据导入到 https://mapshaper.org/ 导出即可。\r\n\r\n![159-5](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-5.png)\r\n\r\n\r\n\r\n如果无法打开网站还可以在本地搭建服务，依赖 Node.js ，命令行安装即可。\r\n\r\n```\r\nnpm install -g mapshaper\r\n```\r\n\r\n安装好以后，通过命令启动服务；在本地运行 mapshaper Web 界面\r\n\r\n```\r\nmapshaper-gui\r\n```\r\n\r\n也可以通过命令行的方式来进行 GeoJSON 转换为  TopoJSON ; -i 是输入 GeoJSON 路径； -o 是输出 TopoJSON 路径。\r\n\r\n```\r\nmapshaper -i D:\\Desktop\\map\\map_data\\geo\\country\\L0_L1_country.json -o D:\\Desktop\\map\\map_data\\topo\\country\\L0_L1_country.json format=topojson\r\n```\r\n\r\n更多的信息可以参考：https://github.com/mbloch/mapshaper\r\n\r\nPython 配合 mapshaper 可以批量地拆分和转换 GeoJSON 数据。\r\n\r\n以上工作笔者已经做好了，只需要在附件中获取清洗好的现成数据即可。\r\n\r\n![159-6](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-6.png)\r\n\r\ntopo中有三个文件 country、province、city 文件夹中的内容命令规则如下，其中 adcode 代表地区的编码。\r\n\r\n这样可满足合并和拆分的地图数据的需求。\r\n\r\n| #    | L0-全国 | L1-省份 | L2-地市 | L3-区县 | 文件夹   | 文件命名规则          |\r\n| ---- | ------- | ------- | ------- | ------- | -------- | --------------------- |\r\n| 1    | √       | √       |         |         | country  | L0_L1_country         |\r\n| 2    | √       | √       | √       |         | country  | L0_L2_country         |\r\n| 3    | √       | √       | √       | √       | country  | L0_L3_country         |\r\n| 4    |         | √       | √       |         | province | L1_L2_province_adcode |\r\n| 5    |         | √       | √       | √       | province | L1_L3_province_adcode |\r\n| 6    |         |         | √       | √       | city     | L2_L3_city_adcode     |\r\n\r\n\r\n\r\n### 2、区域维度数据\r\n\r\n如下图，从大区>省份>城市>区县 四个维度的数据分别都整理好了，同时兼容了直辖市、特区、县级市以及湾湾的层级数据。\r\n\r\n![159-7](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-7.png)\r\n\r\n\r\n\r\n### 3、模型关系\r\n\r\n数据基本介绍，请在之前的文章中查阅(https://jiaopengzi.com/1435.html)。\r\n\r\n![159-8](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-8.png)\r\n\r\n\r\n\r\n## 三、度量值及可视化\r\n\r\n### 1、度量值\r\n\r\n\r\n\r\n![159-9](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-9.png)\r\n\r\nⅠ、基础的业务度量值：0001_销售金额。\r\n\r\n```dax\r\n0001_销售金额 = \r\nSUM ( 'T05_订单子表'[F_06_产品销售金额] ) / 10000 \r\n```\r\n\r\n\r\n\r\nⅡ、市场占有结论语句度量值：Map_Area_Count ；L1-L3分别代表省份、地市、区县。\r\n\r\n```dax\r\nMap_Area_Count_L1 = \r\nVAR Table_ID =\r\n    VALUES ( 'D01_省份表'[F_02_省ID] )\r\nVAR Table_All =\r\n    ADDCOLUMNS ( Table_ID, \"@value\", [0001_销售金额] )\r\nVAR Table_Sale = FILTER( Table_All ,[@value] <> BLANK())\r\nVAR FZ =\r\n    COUNTROWS ( Table_Sale )\r\nVAR FM =\r\n    COUNTROWS ( 'D01_省份表' )\r\nVAR Format_1 =\r\n    FORMAT ( DIVIDE ( FZ, FM, BLANK () ), \"#0,0.0%\" )\r\nRETURN\r\n    \"省级市场共计：\" & FM & \"个，已开拓：\" & FZ & \"个；占比：\" & Format_1\r\n```\r\n\r\n\r\n\r\nⅢ、数据向下钻取后标题名称：Map_Area_Title ；L1-L2分别代表省份、地市。\r\n\r\n```dax\r\nMap_Area_Title_L1 = SELECTEDVALUE('D01_省份表'[F_05_省简称2])\r\n```\r\n\r\n\r\n\r\nⅣ、数据向下钻取后，形状地图的色彩饱和度度量值：Map_Drill ；L2-L3分别代表地市、区县。这里需要兼容一个形状地图不显示没有数据的区域，那么我们需要构造下钻后的所有区域的数据，没有的数据就是 0 。\r\n\r\n```dax\r\nMap_Drill_L2 = \r\nVAR PARENT_ID =\r\n    SELECTEDVALUE ( 'D02_城市表'[F_01_省ID] )\r\nVAR TABLEY =\r\n    ADDCOLUMNS (\r\n        'D02_城市表',\r\n        \"@VALUE\",\r\n            VAR p = [F_01_省ID]\r\n            RETURN\r\n                IF ( p = PARENT_ID, '00_Measure'[0001_销售金额] + 0, '00_Measure'[0001_销售金额] )\r\n    )\r\nVAR TABLEZ =\r\n    FILTER ( TABLEY, [F_01_省ID] = PARENT_ID )\r\nRETURN\r\n    SUMX ( TABLEZ, [@VALUE] )\r\n```\r\n\r\n\r\n\r\nⅤ、由于 Power BI 目前是图例来显示数据的多少的，我们用 SVG 构造一个图例：SVG_Html_Legend ;L1-L3分别代表省份、地市、区县。\r\n\r\n```dax\r\nSVG_Html_Legend_L1 = \r\nVAR table_all =\r\n    CALCULATETABLE ( 'D01_省份表', ALL ( 'D01_省份表'[F_02_省ID] ) )\r\nVAR table_add =\r\n    ADDCOLUMNS ( table_all, \"@value\", [0001_销售金额] )\r\nVAR value_max =\r\n    FORMAT ( MAXX ( table_add, [@value] ), \"#,0\" )\r\nVAR value_min =\r\n    FORMAT ( MINX ( table_add, [@value] ), \"#,0\" )\r\nVAR value_ac =\r\n    FORMAT ( [0001_销售金额], \"#,0\" )\r\nVAR FM =\r\n    MAXX ( table_add, [@value] ) - MINX ( table_add, [@value] )\r\nVAR FZ =\r\n    MAXX ( table_add, [@value] ) - [0001_销售金额]\r\nVAR path_y = 160 * FZ / FM + 20\r\nVAR TF0 =\r\n    HASONEVALUE ( 'D01_省份表'[F_02_省ID] )\r\nVAR TF1 =\r\n    HASONEFILTER ( 'D01_省份表'[F_04_省简称1] ) \r\nVAR SVG_start_image = \"data:image/svg+xml;utf8,\" //SVG 图像类型头部。\r\nVAR SVG_start_html = \"<svg id='jiaopengzi' width='100' height='200' viewBox='0 0 100 200' xmlns='http://www.w3.org/2000/svg' version='1.1'>\" //SVG html类型头部。\r\nVAR SVG_end = \"</svg>\"//SVG 结束标签。\r\nVAR SVG_defs = \"\r\n\t<defs>\r\n\t\t<linearGradient id='jiaopengzi-linear' x1='0%' y1='100%' x2='0%' y2='0%'>\r\n\t\t\t<stop offset='0%' stop-color='#FFFFDD' />\r\n\t\t\t<stop offset='100%' stop-color='#C19220' />\r\n\t\t</linearGradient>\r\n\t</defs>\r\n\" \r\nVAR SVG_content_0 = \"\r\n\t<rect x='0' y='20' width='32' height='160' fill='url(#jiaopengzi-linear)' />\r\n\t<g fill='#1E2F56' font-family='Microsoft Yahei' font-size='10' text-anchor='start' font-weight='bold'>\r\n\t\t<text x='32' y='20' dominant-baseline='text-after-edge'>\" & value_max & \"</text>\r\n\t\t<text x='32' y='180' dominant-baseline='text-before-edge'>\" & value_min & \"</text>\r\n\t</g>\r\n\"// 当没有筛选的时候，path 中间的 text 不出现。\r\nVAR SVG_content_1 = \"\r\n\t<rect x='0' y='20' width='32' height='160' fill='url(#jiaopengzi-linear)' />\r\n\t<path fill='red' stroke='' d='M0 0 L-10 -5 L-10 5 Z' transform='translate(32,\" & path_y & \")' />\r\n\t<g fill='#1E2F56' font-family='Microsoft Yahei' font-size='10' text-anchor='start' font-weight='bold'>\r\n\t\t<text x='32' y='20' dominant-baseline='text-after-edge'>\" & value_max & \"</text>\r\n\t\t<text x='32' y='\" & path_y & \"' dominant-baseline='middle'>\" & value_ac & \"</text>\r\n\t\t<text x='32' y='180' dominant-baseline='text-before-edge'>\" & value_min & \"</text>\r\n\t</g>\r\n\"\r\nVAR SVG_content1 =\r\n    IF ( TF0 * TF1, SVG_content_1, SVG_content_0 )\r\nVAR SVG_content =\r\n    SWITCH ( TRUE (), TF0 && TF1, SVG_content_0, TF0, SVG_content_1, SVG_content_0 )\r\nVAR SVG_html = SVG_start_html & SVG_defs & SVG_content & SVG_end\r\nVAR SVG_image = SVG_start_image & SVG_html\r\nRETURN\r\n    SVG_html\r\n```\r\n\r\nⅥ、最后在形状地图工具提示中增加区域层级显示。\r\n\r\n```dax\r\nTips_Org_Map = \r\nVAR L0 =\r\n    CALCULATE ( SELECTEDVALUE ( 'D00_大区表'[F_02_大区] ), 'D03_区县表' )\r\nVAR L1 =\r\n    CALCULATE ( SELECTEDVALUE ( 'D01_省份表'[F_05_省简称2] ), 'D03_区县表' )\r\nVAR L2 =\r\n    CALCULATE ( SELECTEDVALUE ( 'D02_城市表'[F_03_城市] ), 'D03_区县表' )\r\nVAR L3 =\r\n    SELECTEDVALUE ( 'D03_区县表'[F_03_区县] )\r\nVAR TF1 =\r\n    HASONEVALUE ( 'D01_省份表'[F_05_省简称2] )\r\nVAR TF2 =\r\n    HASONEVALUE ( 'D02_城市表'[F_03_城市] )\r\nVAR TF3 =\r\n    HASONEVALUE ( 'D03_区县表'[F_03_区县] )\r\nVAR ORG =\r\n    SWITCH (\r\n        TRUE (),\r\n        TF3,\r\n            L0 & \"|\" & L1 & \"|\" & L2 & \"|\" & L3,\r\n        TF2,\r\n            L0 & \"|\" & L1 & \"|\" & L2,\r\n        TF1,\r\n            L0 & \"|\" & L1,\r\n        L0 & \"|\" & L1\r\n    )\r\nRETURN\r\n    ORG\r\n```\r\n\r\n\r\n\r\n### 2、可视化\r\n\r\n我们重点介绍案例中的形状地图，其它的内容可以在附件中查看。\r\n\r\n![159-10](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-10.png)\r\n\r\n\r\n\r\n在设置视觉对象格式下面，打开地图设置，映射类型选择：自定义地图；添加上文提到的 TopoJSON 格式的地图，投影根据自身需要选择，一般选择 Mercator 。\r\n\r\n注意这里的映射字段，形状地图 TopoJSON 数据清洗过后，只有两个关键字段，一个 adcode  另外一个是 name ，我们使用 adcode 作为唯一表示，因为 name 可能会重复。\r\n\r\n省市县分别对应到我们的维度表里面省市县的 ID 。\r\n\r\n![159-11](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-11.png)\r\n\r\n\r\n\r\n图例，根据条件创建度量值，使用三方视觉对象 HTML Content 制作最大值和最小值的颜色过渡图例，当选中地图元素可以显示具体位置。\r\n\r\n![159-12](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-12.png)\r\n\r\n\r\n\r\n在形状地图中可以钻取到下层数据。\r\n\r\n![159-13](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-13.png)\r\n\r\n\r\n\r\n下钻后的页面以及度量值关系，区县的数据同理。\r\n\r\n![159-14](https://image.jiaopengzi.com/wp-content/uploads/2022/07/159-14.png)\r\n\r\n\r\n\r\n## 四、总结\r\n\r\n1、形状地图目前还是预览的状态，必须在 Power BI Desktop 中启用。 若要启用“形状地图”，请选择“文件”>“选项和设置”>“选项”>“预览功能”，然后选中“形状地图视觉对象”复选框。\r\n\r\n2、目前形状地图还有很多不灵活的地方，比如不能在地图上显示文本标签，地图填充颜色还是写死的，不能通过 DAX 来动态驱动。\r\n\r\n3、当前区县一级的 TopoJson 比较大，使用的时候及时保存，避免不要的麻烦。\r\n\r\n4、由于历史原因，当前地图数据对于湾湾的数据只有一个大致的，没有更细粒度的数据。更细粒度的数据应该在不远的将来可以使用了。\r\n\r\n\r\n\r\n## 附件下载\r\n\r\n**https://jiaopengzi.com/2816.html**\r\n\r\n\r\n\r\n## 视频课\r\n\r\n**https://jiaopengzi.com/all-course**\r\n\r\n",S="/*\r\n  按Ctrl+F可格式化\r\n*/\r\n\r\n\r\n/* 一级标题样式 */\r\n\r\nh1 {\r\n\r\n}\r\n\r\n\r\n/* 二级标题样式 */\r\n\r\nh2 {\r\n\r\n}\r\n\r\n\r\n/* 三级标题样式 */\r\n\r\nh3 {\r\n\r\n}\r\n\r\n\r\n/* 四级标题样式 */\r\n\r\nh4 {\r\n\r\n}\r\n\r\n\r\n/* 图片样式 */\r\n\r\nimage {\r\n\r\n}\r\n\r\n\r\n/* 引用样式 */\r\n\r\nblockquote {\r\n\r\n}\r\n\r\n\r\n/* 引用段落样式 */\r\n\r\nblockquote_p {\r\n\r\n}\r\n\r\n\r\n/* 段落样式 */\r\n\r\np {\r\n\r\n}\r\n\r\n\r\n/* 分割线样式 */\r\n\r\nhr {\r\n\r\n}\r\n\r\n\r\n/* 行内代码样式 */\r\n\r\ncodespan {\r\n\r\n}\r\n\r\n\r\n/* 粗体样式 */\r\n\r\nstrong {\r\n\r\n}\r\n\r\n\r\n/* 链接样式 */\r\n\r\nlink {\r\n\r\n}\r\n\r\n\r\n/* 微信链接样式 */\r\n\r\nwx_link {\r\n\r\n}\r\n\r\n\r\n/* 有序列表样式 */\r\n\r\nol {\r\n\r\n}\r\n\r\n\r\n/* 无序列表样式 */\r\n\r\nul {\r\n\r\n}\r\n\r\n\r\n/* 列表项样式 */\r\n\r\nli {\r\n\r\n}\r\n\r\n\r\n/* 代码块样式 */\r\n\r\ncode {\r\n\r\n}",y=o("325b"),k=o.n(y),O=o("d238"),v=o.n(O),w=o("4fc3"),x=o.n(w);let E="#1E2f56";var T={BASE:{"text-align":"left","line-height":"1.75"},block:{h1:{"font-size":"18px","text-align":"center","font-weight":"bold",display:"table",margin:"2em auto 1em",padding:"0 1em","border-bottom":"2px solid rgba(0, 152, 116, 0.9)",color:E},h2:{"font-size":"16px","text-align":"center","font-weight":"bold",display:"table",margin:"4em auto 2em",padding:"0 0.2em",background:E,color:"#fff"},h3:{"font-weight":"bold","font-size":"15px",margin:"2em 8px 0.75em 0","line-height":"1.2","padding-left":"8px","border-left":"3px solid #1E2f56",color:E},h4:{"font-weight":"bold","font-size":"14px",margin:"2em 8px 0.5em",color:"rgba(66, 185, 131, 0.9)"},p:{margin:"1.5em 8px","font-size":"14px","line-height":"1.618","letter-spacing":"1px",color:E},blockquote:{"font-style":"normal","border-left":"4px solid #C19220",padding:"1em","border-radius":"8px",color:"rgba(0,0,0,0.5)",background:"#f7f7f7",margin:"2em 8px"},blockquote_p:{"letter-spacing":"0.1em",color:E,"font-size":"14px","line-height":"1.5","letter-spacing":"1px",display:"block"},code_pre:{"font-size":"14px","overflow-x":"auto","border-radius":"8px",padding:"1em","line-height":"1.5",margin:"10px 8px"},code:{margin:0,"white-space":"nowrap","font-family":"Menlo, Operator Mono, Consolas, Monaco, monospace"},image:{"border-radius":"4px",display:"block",margin:"0.1em auto 0.5em",width:"100% !important"},ol:{"margin-left":"0","padding-left":"1em",color:E},ul:{"margin-left":"0","padding-left":"1em","list-style":"circle",color:E},footnotes:{margin:"0.5em 8px","font-size":"80%",color:E},figure:{margin:"1.5em 8px",color:E},hr:{"border-style":"solid","border-width":"1px 0 0","border-color":"rgba(0,0,0,0.1)","-webkit-transform-origin":"0 0","-webkit-transform":"scale(1, 0.5)","transform-origin":"0 0",transform:"scale(1, 0.5)"}},inline:{listitem:{"text-indent":"-1em",display:"block",margin:"0.2em 8px",color:E},codespan:{"font-size":"90%",color:"#888",background:"rgba(27,31,35,.05)",padding:"3px 5px","border-radius":"4px","word-break":"break-all"},link:{color:"#569cd6","text-decoration":"none","font-size":"12px","font-style":"italic"},wx_link:{color:"#569cd6","text-decoration":"none","font-size":"14px","font-style":"italic"},strong:{color:"#888","font-weight":"bold"},table:{"border-collapse":"collapse","text-align":"center",margin:"1em 8px",color:E},thead:{background:"rgba(0, 0, 0, 0.05)","font-weight":"bold",color:E},td:{border:"1px solid #dfdfdf",padding:"0.25em 0.5em",color:E},footnote:{"font-size":"12px",color:E},figcaption:{"text-align":"center",color:"#888","font-size":"0.8em"}}};const A=(e,t)=>{const o=JSON.parse(JSON.stringify(e));return o.block.h1["border-bottom"]="2px solid "+t,o.block.h2["background"]=t,o.block.h3["border-left"]="3px solid "+t,o.block.h4["color"]=t,o.inline.strong["color"]=t,o};function $(e){return t=>A(e,t)}function M(e,t){return A(e,t)}function D(e){return function(t){const o=JSON.parse(JSON.stringify(e));return o.block.h1["font-size"]=1.14*t+"px",o.block.h2["font-size"]=1.1*t+"px",o.block.h3["font-size"]=t+"px",o.block.h4["font-size"]=t+"px",o}}const I=$(T),L=D(T);function j(e,t,o){const n=A(o,t);return n.block.h1=Object.assign(n.block.h1,e.h1),n.block.h2=Object.assign(n.block.h2,e.h2),n.block.h3=Object.assign(n.block.h3,e.h3),n.block.h4=Object.assign(n.block.h4,e.h4),n.block.code=Object.assign(n.block.code,e.code),n.block.p=Object.assign(n.block.p,e.p),n.block.hr=Object.assign(n.block.hr,e.hr),n.block.blockquote=Object.assign(n.block.blockquote,e.blockquote),n.block.blockquote_p=Object.assign(n.block.blockquote_p,e.blockquote_p),n.block.image=Object.assign(n.block.image,e.image),n.inline.strong=Object.assign(n.inline.strong,e.strong),n.inline.codespan=Object.assign(n.inline.codespan,e.codespan),n.inline.link=Object.assign(n.inline.link,e.link),n.inline.wx_link=Object.assign(n.inline.wx_link,e.wx_link),n.block.ul=Object.assign(n.block.ul,e.ul),n.block.ol=Object.assign(n.block.ol,e.ol),n.inline.listitem=Object.assign(n.inline.listitem,e.li),n}function R(e){let t,o;while(-1!==(t=e.indexOf("/*"))&&-1!==(o=e.indexOf("*/")))e=e.substring(0,t)+e.substring(o+2);let n={};while(e.length>0&&-1!==e.indexOf("{")&&-1!==e.indexOf("}")){const t=e.indexOf("{"),o=e.indexOf("}");function r(e){let t={};return e.forEach(e=>{const o=e.indexOf(":"),n=e.substring(0,o).trim();t[n]=e.substring(o+1).trim()}),t}let i=e.substring(t+1,o).split(";").map(e=>e.trim()).filter(e=>e.length>0);i=r(i);let s=e.substring(0,t).split(",").map(e=>e.trim());s.forEach(e=>{n[e]||(n[e]={}),Object.keys(i).forEach(t=>{n[e][t]=i[t]})}),e=e.slice(o+1).trim()}return n}function P(e,t){const o=e.getValue(0);o?localStorage.setItem(t,o):localStorage.removeItem(t)}function z(e){return k.a.format(e,{parser:"markdown",plugins:[x.a]})}function V(e){return k.a.format(e,{parser:"css",plugins:[v.a]})}function F(e){const t=document.createElement("a");t.download="content.md",t.style.display="none";const o=new Blob([e]);t.href=URL.createObjectURL(o),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function U(){const e=document.querySelector("#output");r(e);const t=e.innerHTML,o=document.createElement("a");o.download="content.html",o.style.display="none";let n=new Blob([`<html><head><meta charset="utf-8" /></head><body><div style="width: 750px; margin: auto;">${t}</div></body></html>`]);function r(e){function t(e,t=["width","height"]){const o=getComputedStyle(e,null);return Object.entries(o).filter(([e])=>o.getPropertyValue(e)&&!t.includes(e)).map(([e,t])=>`${e}:${t};`).join("")}switch(!0){case o(e):case n(e):case i(e):e.setAttribute("style",t(e));default:}function o(e){return"PRE"===e.tagName&&Array.from(e.classList).includes("code__pre")}function n(e){return"CODE"===e.tagName&&Array.from(e.classList).includes("prettyprint")}function i(e){return"SPAN"===e.tagName&&(n(e.parentElement)||n(e.parentElement.parentElement))}e.children.length&&Array.from(e.children).forEach(e=>r(e))}o.href=URL.createObjectURL(n),document.body.appendChild(o),o.click(),document.body.removeChild(o)}function B({data:e,rows:t,cols:o}){let n="";for(let r=0;r<t+2;++r){n+="| ";const t=[];for(let n=0;n<o;++n){const o=r>1?r-1:r;t.push(1===r?"---":e[`k_${o}_${n}`]||"     ")}n+=t.join(" | "),n+=" |\n"}return n}function K(e){return new Promise((t,o)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>t(n.result.split(",").pop()),n.onerror=e=>o(e)})}function N(e){const t=/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(e.name);if(!t)return{ok:!1,msg:"请上传 JPG/PNG/GIF 格式的图片"};const o=10,n=e.size/1024/1024<=o;return n?{ok:!0}:{ok:!1,msg:`由于公众号限制，图片大小不能超过 ${o}M`}}function H(e){const t=e.split("\n"),o=t.filter(e=>e.trim()).map(e=>e.match(/(^\s+)?/)[0].length).sort((e,t)=>e-t)[0];return t.map(e=>e.slice(o)).join("\n")}n["default"].use(d["a"]);const q={wxRenderer:null,output:"",html:"",editor:null,cssEditor:null,currentFont:"",currentSize:"",currentColor:"",citeStatus:!1,nightMode:!1,codeTheme:u.codeThemeOption[0].value,isMacCodeBlock:!0},G={setEditorValue(e,t){e.editor.setValue(t)},setCssEditorValue(e,t){e.cssEditor.setValue(t)},setWxRendererOptions(e,t){e.wxRenderer.setOptions(t)},setCiteStatus(e,t){e.citeStatus=t,localStorage.setItem("citeStatus",t)},setCurrentFont(e,t){e.currentFont=t,localStorage.setItem("fonts",t)},setCurrentSize(e,t){e.currentSize=t,localStorage.setItem("size",t)},setCurrentColor(e,t){e.currentColor=t,localStorage.setItem("color",t)},setCurrentCodeTheme(e,t){e.codeTheme=t,localStorage.setItem("codeTheme",t)},setIsMacCodeBlock(e,t){e.isMacCodeBlock=t,localStorage.setItem("isMacCodeBlock",t)},themeChanged(e){e.nightMode=!e.nightMode,localStorage.setItem("nightMode",e.nightMode)},initEditorState(e){e.currentFont=localStorage.getItem("fonts")||u.builtinFonts[0].value,e.currentColor=localStorage.getItem("color")||u.colorOption[0].value,e.currentSize=localStorage.getItem("size")||u.sizeOption[2].value,e.codeTheme=localStorage.getItem("codeTheme")||u.codeThemeOption[0].value,e.citeStatus="true"===localStorage.getItem("citeStatus"),e.nightMode="true"===localStorage.getItem("nightMode"),e.isMacCodeBlock=!("false"===localStorage.getItem("isMacCodeBlock")),e.wxRenderer=new g({theme:I(e.currentColor),fonts:e.currentFont,size:e.currentSize})},initEditorEntity(e){const t=document.getElementById("editor");t.value||(t.value=localStorage.getItem("__editor_content")||z(C)),e.editor=b.a.fromTextArea(t,{mode:"text/x-markdown",theme:"xq-light",lineNumbers:!1,lineWrapping:!0,styleActiveLine:!0,autoCloseBrackets:!0,extraKeys:{"Ctrl-F":function(e){const t=z(e.getValue(0));localStorage.setItem("__editor_content",t),e.setValue(t)},"Ctrl-S":function(e){},"Ctrl-B":function(e){const t=e.getSelection();e.replaceSelection(`**${t}**`)},"Ctrl-D":function(e){const t=e.getSelection();e.replaceSelection(`~~${t}~~`)},"Ctrl-I":function(e){const t=e.getSelection();e.replaceSelection(`*${t}*`)}}})},initCssEditorEntity(e){const t=document.getElementById("cssEditor");t.value||(t.value=localStorage.getItem("__css_content")||S),e.cssEditor=b.a.fromTextArea(t,{mode:"css",theme:"style-mirror",lineNumbers:!1,lineWrapping:!0,matchBrackets:!0,autofocus:!0,extraKeys:{"Ctrl-F":function(e){const t=V(e.getValue(0));localStorage.setItem("__css_content",t),e.setValue(t)},"Ctrl-S":function(e){}}})},editorRefresh(e){const t=e.wxRenderer.getRenderer(e.citeStatus);m["marked"].setOptions({renderer:t});let o=m["marked"].parse(e.editor.getValue(0));o=o.replace(/(style=".*?)"/,'$1;margin-top: 0"'),e.citeStatus&&(o+=e.wxRenderer.buildFootnotes(),o+=e.wxRenderer.buildAddition()),e.output=o}};var W=new d["a"].Store({state:q,mutations:G,actions:{}}),J=o("5c96"),Q=o.n(J);o("0fae");n["default"].component(J["Message"].name,J["Message"]),n["default"].prototype.$loading=J["Loading"].service,n["default"].prototype.$message=J["Message"];o("a7be"),o("8d7e"),o("7b00"),o("959b"),o("10b2"),o("8c33"),o("31c5"),o("9b74"),o("111b");var X=o("8c4f"),Y=function(){var e=this,t=e._self._c;return t("codemirror-editor")},Z=[],ee=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container",class:{container_night:e.nightMode},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"k",void 0,t.key,void 0)?null:t.altKey&&t.shiftKey?void e.addFormat("[","]()"):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"u",void 0,t.key,void 0)?null:t.altKey&&t.shiftKey?e.addFormat("~~"):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"l",void 0,t.key,void 0)?null:t.ctrlKey&&t.altKey?e.formatContent():null}]}},[t("el-container",[t("el-header",{staticClass:"editor__header"},[t("editor-header",{ref:"header",on:{addFormat:e.addFormat,formatContent:e.formatContent,refresh:e.onEditorRefresh,cssChanged:e.cssChanged,"import-md":e.importMD,download:e.downloadEditorContent,export:e.exportEditorContent,showCssEditor:function(t){e.showCssEditor=!e.showCssEditor},"show-about-dialog":function(t){e.aboutDialogVisible=!0},"show-dialog-form":function(t){e.insertFormDialogVisible=!0},"show-dialog-upload-img":function(t){e.dialogUploadImgVisible=!0},startCopy:function(t){e.isCoping=!0,e.backLight=!0},endCopy:e.endCopy}})],1),t("el-main",{staticClass:"main-body"},[t("el-row",{staticClass:"main-section"},[t("el-col",{ref:"codeMirrorWrapper",staticClass:"codeMirror-wrapper",attrs:{span:12},nativeOn:{contextmenu:function(t){return t.preventDefault(),e.openMenu.apply(null,arguments)}}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.source,expression:"source"}],attrs:{id:"editor",type:"textarea",placeholder:"Your markdown text here."},domProps:{value:e.source},on:{input:function(t){t.target.composing||(e.source=t.target.value)}}})]),t("el-col",{ref:"preview",staticClass:"preview-wrapper",class:{"preview-wrapper_night":e.nightMode&&e.isCoping},attrs:{span:12,id:"preview"}},[t("section",{class:{output_night:e.nightMode&&!e.backLight},attrs:{id:"output-wrapper"}},[t("div",{staticClass:"preview"},[t("section",{attrs:{id:"output"},domProps:{innerHTML:e._s(e.output)}}),e.nightMode&&e.isCoping?t("div",{staticClass:"loading-mask"},[t("div",{staticClass:"loading__img"}),t("span",[e._v("正在生成")])]):e._e()])])]),t("css-editor",{attrs:{"show-css-editor":e.showCssEditor}})],1)],1)],1),t("upload-img-dialog",{attrs:{visible:e.dialogUploadImgVisible},on:{close:function(t){e.dialogUploadImgVisible=!1},beforeUpload:e.beforeUpload,uploadImage:e.uploadImage,uploaded:e.uploaded}}),t("about-dialog",{attrs:{visible:e.aboutDialogVisible},on:{close:function(t){e.aboutDialogVisible=!1}}}),t("insert-form-dialog",{attrs:{visible:e.insertFormDialogVisible},on:{close:function(t){e.insertFormDialogVisible=!1}}}),t("right-click-menu",{attrs:{visible:e.rightClickMenuVisible,left:e.mouseLeft,top:e.mouseTop},on:{menuTick:e.onMenuEvent,closeMenu:function(t){e.rightClickMenuVisible=!1}}}),t("run-loading")],1)},te=[],oe=(o("a1f0"),function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"header-container is-dark"},[t("div",{staticClass:"dropdowns"},[t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v(" 文件"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.refClick.apply(null,arguments)}}},[t("i",{staticClass:"el-icon-upload2"}),e._v(" 导入 .md "),t("input",{ref:"fileInput",attrs:{hidden:"",type:"file",accept:".md"}})]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.$emit("download")}}},[t("i",{staticClass:"el-icon-download"}),e._v(" 导出 .md ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.$emit("export")}}},[t("i",{staticClass:"el-icon-document"}),e._v(" 导出 .html ")]),t("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(t){return e.themeChanged.apply(null,arguments)}}},[t("i",{staticClass:"el-icon-check",style:{opacity:e.nightMode?1:0}}),e._v(" 暗黑模式 ")])],1)],1),t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v(" 格式"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e._l(e.formatItems,(function({label:o,kbd:n,emitArgs:r}){return t("el-dropdown-item",{key:n,staticClass:"format-item",nativeOn:{click:function(t){return e.$emit(...r)}}},[e._v(" "+e._s(o)+" "),t("kbd",[e._v(e._s(n))])])})),t("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(t){return e.statusChanged.apply(null,arguments)}}},[t("i",{staticClass:"el-icon-check",style:{opacity:e.citeStatus?1:0}}),e._v(" 微信外链转底部引用 ")])],2)],1),t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v(" 编辑"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.$emit("show-dialog-upload-img")}}},[t("i",{staticClass:"el-icon-upload"}),e._v(" 上传图片 ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.$emit("show-dialog-form")}}},[t("i",{staticClass:"el-icon-s-grid"}),e._v(" 插入表格 ")])],1)],1),t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v(" 样式"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{staticClass:"padding-left-3"},[t("style-option-menu",{attrs:{label:"字体",options:e.config.builtinFonts,current:e.selectFont,charge:e.fontChanged}})],1),t("el-dropdown-item",{staticClass:"padding-left-3"},[t("style-option-menu",{attrs:{label:"字号",options:e.config.sizeOption,current:e.selectSize,charge:e.sizeChanged}})],1),t("el-dropdown-item",{staticClass:"padding-left-3"},[t("style-option-menu",{attrs:{label:"颜色",options:e.config.colorOption,current:e.selectColor,charge:e.colorChanged}})],1),t("el-dropdown-item",{staticClass:"padding-left-3"},[t("style-option-menu",{attrs:{label:"代码主题",options:e.config.codeThemeOption,current:e.selectCodeTheme,charge:e.codeThemeChanged}})],1),t("el-dropdown-item",{staticClass:"padding-left-3",attrs:{divided:""},nativeOn:{click:function(t){return e.showPicker()}}},[e._v(" 自定义颜色 "),t("el-color-picker",{ref:"colorPicker",staticStyle:{float:"right","margin-top":"3px"},attrs:{"show-alpha":"",size:"mini"},on:{change:e.colorChanged},model:{value:e.selectColor,callback:function(t){e.selectColor=t},expression:"selectColor"}})],1),t("el-dropdown-item",{staticClass:"padding-left-3",nativeOn:{click:function(t){return e.customStyle.apply(null,arguments)}}},[e._v(" 自定义 CSS ")]),t("el-dropdown-item",{staticClass:"padding-left-3",attrs:{divided:""},nativeOn:{click:function(t){e.showResetConfirm=!0}}},[e._v(" 重置 ")])],1)],1),t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v(" 帮助"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.$emit("show-about-dialog")}}},[e._v(" 关于 ")])],1)],1)],1),t("el-button",{attrs:{plain:"",size:"medium",type:e.btnType},on:{click:e.copy}},[e._v(" 复制 ")]),t("post-info-dialog",{attrs:{form:e.form},on:{post:e.post,close:function(t){e.form.dialogVisible=!1}}}),t("reset-dialog",{attrs:{"show-reset-confirm":e.showResetConfirm},on:{confirm:e.confirmReset,close:e.cancelReset}})],1)}),ne=[],re=o("466b"),ie=o.n(re);function se(){const e=document.getElementById("output"),t=e.getElementsByTagName("img");for(let o=0;o<t.length;o++){const e=t[o],n=e.getAttribute("width"),r=e.getAttribute("height");e.removeAttribute("width"),e.removeAttribute("height"),e.style.width=n,e.style.height=r}}function ae(e){return ie()(e,{inlinePseudoElements:!0,preserveImportant:!0})}var le=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"reset__dialog",attrs:{title:"提示",visible:e.showResetConfirm,center:""},on:{close:function(t){return e.$emit("close")}}},[t("div",{staticStyle:{"text-align":"center"}},[e._v("此操作将丢失本地自定义样式，是否继续?")]),t("template",{slot:"footer"},[t("el-button",{attrs:{type:e.btnType,plain:""},on:{click:function(t){return e.$emit("close")}}},[e._v(" 取 消 ")]),t("el-button",{attrs:{type:e.btnType,plain:""},on:{click:function(t){return e.$emit("confirm")}}},[e._v(" 确 定 ")])],1)],2)},ce=[],de={props:{showResetConfirm:{type:Boolean,default:!1}},computed:{btnType(){return this.nightMode?"default":"primary"},...Object(d["c"])({nightMode:e=>e.nightMode})}},ue=de,me=(o("a803"),Object(s["a"])(ue,le,ce,!1,null,"7fcca3b7",null)),pe=me.exports,fe=function(){var e=this,t=e._self._c;return t("el-dropdown",{staticClass:"style-option-menu",attrs:{placement:"right"}},[t("div",{staticClass:"el-dropdown-link"},[e._v(" "+e._s(e.label)+" "),t("i",{staticClass:"el-icon-arrow-right el-icon--right"})]),t("el-dropdown-menu",{staticStyle:{width:"200px"},attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.options,(function({value:o,label:n,desc:r}){return t("el-dropdown-item",{key:o,attrs:{label:n,value:o},nativeOn:{click:function(t){return e.charge(o)}}},[t("i",{staticClass:"el-icon-check",style:{opacity:e.current===o?1:0}}),e._v(" "+e._s(n)+" "),t("span",{staticClass:"select-item-right"},[e._v(e._s(r))])])})),1)],1)},he=[],ge={name:"StyleOptionMenu",props:{label:{type:String,required:!0},options:{type:Array,required:!0},current:{type:String,required:!0},charge:{type:Function,required:!0}}},_e=ge,be=(o("63fe"),Object(s["a"])(_e,fe,he,!1,null,"32cf930a",null)),Ce=be.exports,Se=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"发布",visible:e.form.dialogVisible},on:{"update:visible":function(t){return e.$set(e.form,"dialogVisible",t)}}},[t("el-alert",{staticStyle:{"margin-bottom":"1em"},attrs:{title:"注：此功能由第三方浏览器插件支持，本平台不保证安全性。",type:"info","show-icon":""}}),t("el-form",{staticClass:"postInfo",attrs:{"label-position":"right","label-width":"50px",model:e.form}},[t("el-form-item",{attrs:{label:"封面"}},[t("el-input",{attrs:{placeholder:"自动提取第一张图"},model:{value:e.form.thumb,callback:function(t){e.$set(e.form,"thumb",t)},expression:"form.thumb"}})],1),t("el-form-item",{attrs:{label:"标题"}},[t("el-input",{attrs:{placeholder:"自动提取第一个标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),t("el-form-item",{attrs:{label:"描述"}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"自动提取第一个段落"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1),t("template",{staticClass:"dialog-footer",slot:"footer"},[t("el-button",{on:{click:function(t){return e.$emit("close")}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("post")}}},[e._v("确 定")])],1)],2)},ye=[],ke={name:"PostInfoDialog",props:{form:{type:Object}}},Oe=ke,ve=Object(s["a"])(Oe,Se,ye,!1,null,"4ab4b77e",null),we=ve.exports,xe={name:"editor-header",data(){return{config:u,citeStatus:!1,isMacCodeBlock:!0,showResetConfirm:!1,selectFont:"",selectSize:"",selectColor:"",selectCodeTheme:u.codeThemeOption[0].value,form:{dialogVisible:!1,title:"",desc:"",thumb:"",content:""},formatItems:[{label:"加粗",kbd:"Ctrl + B",emitArgs:["addFormat","**"]},{label:"斜体",kbd:"Ctrl + I",emitArgs:["addFormat","*"]},{label:"删除线",kbd:"Alt + Shift + U",emitArgs:["addFormat","~~"]},{label:"超链接",kbd:"Alt + Shift + K",emitArgs:["addFormat","[","]()"]},{label:"格式化",kbd:"Alt + Shift + L",emitArgs:["formatContent"]}]}},components:{PostInfoDialog:we,StyleOptionMenu:Ce,ResetDialog:pe},computed:{btnType(){return this.nightMode?"default":"primary"},...Object(d["c"])({output:e=>e.output,editor:e=>e.editor,cssEditor:e=>e.cssEditor,currentFont:e=>e.currentFont,currentSize:e=>e.currentSize,currentColor:e=>e.currentColor,codeTheme:e=>e.codeTheme,nightMode:e=>e.nightMode,currentCiteStatus:e=>e.citeStatus,currentIsMacCodeBlock:e=>e.isMacCodeBlock})},methods:{refClick(){this.$refs.fileInput.click()},showPicker(){this.$refs.colorPicker.showPicker=!0},prePost(){let e={};try{e={thumb:document.querySelector("#output img").src,title:[1,2,3,4,5,6].map(e=>document.querySelector("#output h"+e)).filter(e=>e)[0].innerText,desc:document.querySelector("#output p").innerText,content:this.output}}catch(t){console.log("error",t)}this.form={dialogVisible:!0,...e,auto:e}},post(){this.form.dialogVisible=!1,window.syncPost({title:this.form.title||this.form.auto.title,desc:this.form.desc||this.form.auto.desc,content:this.form.content||this.form.auto.content,thumb:this.form.thumb||this.form.auto.thumb})},fontChanged(e){this.setWxRendererOptions({fonts:e}),this.setCurrentFont(e),this.selectFont=e,this.$emit("refresh")},sizeChanged(e){let t=L(e.replace("px",""));t=M(t,this.currentColor),this.setWxRendererOptions({size:e,theme:t}),this.setCurrentSize(e),this.selectSize=e,this.$emit("refresh")},colorChanged(e){let t=L(this.currentSize.replace("px",""));t=M(t,e),this.setWxRendererOptions({theme:t}),this.setCurrentColor(e),this.selectColor=e,this.$emit("refresh")},codeThemeChanged(e){this.setCurrentCodeTheme(e),this.selectCodeTheme=e,this.$emit("refresh")},statusChanged(){this.citeStatus=!this.citeStatus,this.setCiteStatus(this.citeStatus),this.$emit("refresh")},codeBlockChanged(){this.isMacCodeBlock=!this.isMacCodeBlock,this.setIsMacCodeBlock(this.isMacCodeBlock),this.$emit("refresh")},copy(){this.$emit("startCopy"),setTimeout(()=>{se();const e=document.getElementById("output");e.innerHTML=ae(e.innerHTML),this.isMacCodeBlock&&(e.innerHTML=e.innerHTML.replaceAll(/(<code class="prettyprint.+?(?<=style="))/g,"$1font-family: Menlo, 'Operator Mono', Consolas, Monaco, monospace;")),e.focus(),window.getSelection().removeAllRanges();let t=document.createRange();t.setStartBefore(e.firstChild),t.setEndAfter(e.lastChild),window.getSelection().addRange(t),document.execCommand("copy"),window.getSelection().removeAllRanges(),e.innerHTML=this.output,this.$notify({showClose:!0,message:"已复制渲染后的文章到剪贴板，可直接到公众号后台粘贴",offset:80,duration:1600,type:"success"}),this.$emit("refresh"),this.$emit("endCopy")},350)},async customStyle(){this.$emit("showCssEditor"),this.$nextTick(()=>{this.cssEditor||this.cssEditor.refresh()}),setTimeout(()=>{this.cssEditor.refresh()},50);let e=localStorage.getItem("__css_content");e||this.setCssEditorValue(S)},confirmReset(){this.showResetConfirm=!1,localStorage.clear(),this.cssEditor.setValue(S),this.citeStatus=!1,this.statusChanged(!1),this.fontChanged(this.config.builtinFonts[0].value),this.colorChanged(this.config.colorOption[0].value),this.sizeChanged(this.config.sizeOption[2].value),this.codeThemeChanged(this.config.codeThemeOption[0].value),this.$emit("cssChanged"),this.selectFont=this.currentFont,this.selectSize=this.currentSize,this.selectColor=this.currentColor,this.selectCodeTheme=this.codeTheme,this.isMacCodeBlock=!1,this.codeBlockChanged()},cancelReset(){this.showResetConfirm=!1,this.editor.focus()},...Object(d["b"])(["setCurrentColor","setCiteStatus","themeChanged","setCurrentFont","setCurrentSize","setCssEditorValue","setCurrentCodeTheme","setWxRendererOptions","setIsMacCodeBlock"])},mounted(){this.selectFont=this.currentFont,this.selectSize=this.currentSize,this.selectColor=this.currentColor,this.selectCodeTheme=this.codeTheme,this.citeStatus=this.currentCiteStatus,this.isMacCodeBlock=this.currentIsMacCodeBlock;const e=this.$refs.fileInput;e.onchange=()=>{const t=e.files[0];if(null==t)return;const o=new FileReader;o.readAsText(t),o.onload=()=>{this.$emit("import-md",o.result)}}}},Ee=xe,Te=(o("f6d9"),Object(s["a"])(Ee,oe,ne,!1,null,"434ad209",null)),Ae=Te.exports,$e=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"about__dialog",attrs:{title:"关于",visible:e.visible,width:"30%",center:""},on:{close:function(t){return e.$emit("close")}}},[t("div",{staticStyle:{"text-align":"center"}},[t("h3",[e._v("适配 DAX 的微信 Markdown 编辑器")]),t("p",[e._v("扫码关注公众号 焦棚子，交流更多 DAX 话题！")]),t("img",{staticStyle:{width:"40%"},attrs:{src:"https://jiaopengzi.com/wp-content/uploads/2021/11/weixingongzhonghao.png"}})]),t("template",{slot:"footer"},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.onRedirect("https://github.com/jiaopengzi/md")}}},[e._v(" GitHub 仓库 ")]),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.onRedirect("https://gitee.com/jiaopengzi/md")}}},[e._v(" Gitee 仓库 ")])],1)],2)},Me=[],De={props:{visible:{type:Boolean,default:!1}},methods:{onRedirect(e){window.open(e)}}},Ie=De,Le=(o("0a46"),Object(s["a"])(Ie,$e,Me,!1,null,"7a3e90b4",null)),je=Le.exports,Re=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"insert__dialog",attrs:{title:"插入表格",visible:e.visible,border:""},on:{close:function(t){return e.$emit("close")}}},[t("el-row",{staticClass:"tb-options",attrs:{type:"flex",align:"middle",gutter:10}},[t("el-col",[e._v(" 行数： "),t("el-input-number",{attrs:{"controls-position":"right",min:1,max:100,size:"small"},model:{value:e.rowNum,callback:function(t){e.rowNum=t},expression:"rowNum"}})],1),t("el-col",[e._v(" 列数： "),t("el-input-number",{attrs:{"controls-position":"right",min:1,max:100,size:"small"},model:{value:e.colNum,callback:function(t){e.colNum=t},expression:"colNum"}})],1)],1),t("table",{staticClass:"input-table",staticStyle:{"border-collapse":"collapse"}},e._l(e.rowNum+1,(function(o){return t("tr",{key:o,class:{"head-style":1===o}},e._l(e.colNum,(function(n){return t("td",{key:n},[t("el-input",{attrs:{align:"center",placeholder:1===o?"表头":""},model:{value:e.tableData[`k_${o-1}_${n-1}`],callback:function(t){e.$set(e.tableData,`k_${o-1}_${n-1}`,t)},expression:"tableData[`k_${row - 1}_${col - 1}`]"}})],1)})),0)})),0),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:e.btnType,plain:""},on:{click:function(t){return e.$emit("close")}}},[e._v(" 取 消 ")]),t("el-button",{attrs:{type:e.btnType,plain:""},on:{click:e.insertTable}},[e._v(" 确 定 ")])],1)],1)},Pe=[],ze={props:{visible:{type:Boolean,default:!1}},data(){return{config:u,rowNum:3,colNum:3,tableData:{}}},computed:{btnType(){return this.nightMode?"default":"primary"},...Object(d["c"])({nightMode:e=>e.nightMode,editor:e=>e.editor})},methods:{insertTable(){this.editor.getCursor();const e=B({data:this.tableData,rows:this.rowNum,cols:this.colNum});this.tableData={},this.rowNum=3,this.colNum=3,this.editor.replaceSelection(`\n${e}\n`,"end"),this.$emit("close"),this.editorRefresh()},...Object(d["b"])(["editorRefresh"])}},Ve=ze,Fe=(o("aecf"),Object(s["a"])(Ve,Re,Pe,!1,null,"015ce7b9",null)),Ue=Fe.exports,Be=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"menu",style:`left: ${e.left}px;top: ${e.top}px;`,attrs:{id:"menu"}},e._l(e.menu,(function(o,n){return t("ul",{key:n,staticClass:"menu__group"},e._l(o,(function({key:o,text:n}){return t("li",{key:o,staticClass:"menu_item",on:{mousedown:function(t){return e.onMouseDown(o)}}},[e._v(" "+e._s(n)+" ")])})),0)})),0)},Ke=[],Ne={props:{visible:{type:Boolean,default:!1},top:{type:Number,default:0},left:{type:Number,default:0}},data(){return{menu:[[{text:"上传图片",key:"insertPic"},{text:"插入表格",key:"insertTable"},{text:"恢复默认样式",key:"resetStyle"}],[{text:"导入 .md 文档",key:"importMarkdown"},{text:"导出 .md 文档",key:"download"},{text:"导出 .html",key:"export"},{text:"格式化",key:"formatMarkdown"}]]}},methods:{onMouseDown(e){this.$emit("menuTick",e),this.$emit("closeMenu")}}},He=Ne,qe=(o("ebdd"),Object(s["a"])(He,Be,Ke,!1,null,"283cf1ee",null)),Ge=qe.exports,We=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"upload__dialog",attrs:{title:"本地上传",visible:e.visible},on:{close:function(t){return e.$emit("close")}}},[t("el-tabs",{attrs:{type:"activeName"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{staticClass:"upload-panel",attrs:{label:"选择上传",name:"upload"}},[t("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:e.changeImgHost},model:{value:e.imgHost,callback:function(t){e.imgHost=t},expression:"imgHost"}},e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-upload",{attrs:{drag:"",action:"",headers:{"Content-Type":"multipart/form-data"},"show-file-list":!1,multiple:!0,accept:".jpg, .jpeg, .png, .gif",name:"file","before-upload":e.beforeImageUpload,"http-request":e.uploadImage}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(" 将图片拖到此处，或 "),t("em",[e._v("点击上传")])])])],1),t("el-tab-pane",{staticClass:"github-panel",attrs:{label:"GitHub 图床",name:"github"}},[t("el-form",{staticClass:"setting-form",attrs:{model:e.formGitHub,"label-position":"right","label-width":"140px"}},[t("el-form-item",{attrs:{label:"GitHub 仓库",required:!0}},[t("el-input",{attrs:{placeholder:"如：github.com/yanglbme/resource"},model:{value:e.formGitHub.repo,callback:function(t){e.$set(e.formGitHub,"repo","string"===typeof t?t.trim():t)},expression:"formGitHub.repo"}})],1),t("el-form-item",{attrs:{label:"分支"}},[t("el-input",{attrs:{placeholder:"如：release，可不填，默认 master"},model:{value:e.formGitHub.branch,callback:function(t){e.$set(e.formGitHub,"branch","string"===typeof t?t.trim():t)},expression:"formGitHub.branch"}})],1),t("el-form-item",{attrs:{label:"Token",required:!0}},[t("el-input",{attrs:{"show-password":"",placeholder:"如：cc1d0c1426d0fd0902bd2d7184b14da61b8abc46"},model:{value:e.formGitHub.accessToken,callback:function(t){e.$set(e.formGitHub,"accessToken","string"===typeof t?t.trim():t)},expression:"formGitHub.accessToken"}}),t("el-link",{attrs:{type:"primary",href:"https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token",target:"_blank"}},[e._v("如何获取 GitHub Token？ ")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.saveGitHubConfiguration}},[e._v("保存配置 ")])],1)],1)],1),t("el-tab-pane",{staticClass:"github-panel",attrs:{label:"阿里云 OSS",name:"aliOSS"}},[t("el-form",{staticClass:"setting-form",attrs:{model:e.formAliOSS,"label-position":"right","label-width":"140px"}},[t("el-form-item",{attrs:{label:"AccessKey ID",required:!0}},[t("el-input",{attrs:{placeholder:"如：LTAI4GjpzmdoxUf13ylbaNHk"},model:{value:e.formAliOSS.accessKeyId,callback:function(t){e.$set(e.formAliOSS,"accessKeyId","string"===typeof t?t.trim():t)},expression:"formAliOSS.accessKeyId"}})],1),t("el-form-item",{attrs:{label:"AccessKey Secret",required:!0}},[t("el-input",{attrs:{"show-password":"",placeholder:"如：cc1d0c142jpz0902bd2d7md4b14da6ylbabc46"},model:{value:e.formAliOSS.accessKeySecret,callback:function(t){e.$set(e.formAliOSS,"accessKeySecret","string"===typeof t?t.trim():t)},expression:"formAliOSS.accessKeySecret"}})],1),t("el-form-item",{attrs:{label:"Bucket",required:!0}},[t("el-input",{attrs:{placeholder:"如：jpz"},model:{value:e.formAliOSS.bucket,callback:function(t){e.$set(e.formAliOSS,"bucket","string"===typeof t?t.trim():t)},expression:"formAliOSS.bucket"}})],1),t("el-form-item",{attrs:{label:"Bucket 所在区域",required:!0}},[t("el-input",{attrs:{placeholder:"如：oss-cn-shenzhen"},model:{value:e.formAliOSS.region,callback:function(t){e.$set(e.formAliOSS,"region","string"===typeof t?t.trim():t)},expression:"formAliOSS.region"}})],1),t("el-form-item",{attrs:{label:"自定义 CDN 域名",required:!1}},[t("el-input",{attrs:{placeholder:"如：https://imagecdn.alidaodao.com，可不填"},model:{value:e.formAliOSS.cdnHost,callback:function(t){e.$set(e.formAliOSS,"cdnHost","string"===typeof t?t.trim():t)},expression:"formAliOSS.cdnHost"}})],1),t("el-form-item",{attrs:{label:"存储路径"}},[t("el-input",{attrs:{placeholder:"如：img，可不填，默认为根目录"},model:{value:e.formAliOSS.path,callback:function(t){e.$set(e.formAliOSS,"path","string"===typeof t?t.trim():t)},expression:"formAliOSS.path"}}),t("el-link",{attrs:{type:"primary",href:"https://help.aliyun.com/document_detail/31883.html",target:"_blank"}},[e._v("如何使用阿里云 OSS？ ")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.saveAliOSSConfiguration}},[e._v(" 保存配置 ")])],1)],1)],1),t("el-tab-pane",{staticClass:"github-panel",attrs:{label:"腾讯云 COS",name:"txCOS"}},[t("el-form",{staticClass:"setting-form",attrs:{model:e.formTxCOS,"label-position":"right","label-width":"140px"}},[t("el-form-item",{attrs:{label:"SecretId",required:!0}},[t("el-input",{attrs:{placeholder:"如：AKIDnQp1w3jpzs8F5MDp9tjpzmdUPonW3"},model:{value:e.formTxCOS.secretId,callback:function(t){e.$set(e.formTxCOS,"secretId","string"===typeof t?t.trim():t)},expression:"formTxCOS.secretId"}})],1),t("el-form-item",{attrs:{label:"SecretKey",required:!0}},[t("el-input",{attrs:{"show-password":"",placeholder:"如：ukLmdtEJ9271f3jpzMDsCXdS3YlbW0"},model:{value:e.formTxCOS.secretKey,callback:function(t){e.$set(e.formTxCOS,"secretKey","string"===typeof t?t.trim():t)},expression:"formTxCOS.secretKey"}})],1),t("el-form-item",{attrs:{label:"Bucket",required:!0}},[t("el-input",{attrs:{placeholder:"如：jpz-3212520134"},model:{value:e.formTxCOS.bucket,callback:function(t){e.$set(e.formTxCOS,"bucket","string"===typeof t?t.trim():t)},expression:"formTxCOS.bucket"}})],1),t("el-form-item",{attrs:{label:"Bucket 所在区域",required:!0}},[t("el-input",{attrs:{placeholder:"如：ap-guangzhou"},model:{value:e.formTxCOS.region,callback:function(t){e.$set(e.formTxCOS,"region","string"===typeof t?t.trim():t)},expression:"formTxCOS.region"}})],1),t("el-form-item",{attrs:{label:"自定义 CDN 域名",required:!1}},[t("el-input",{attrs:{placeholder:"如：https://imagecdn.alidaodao.com，可不填"},model:{value:e.formTxCOS.cdnHost,callback:function(t){e.$set(e.formTxCOS,"cdnHost","string"===typeof t?t.trim():t)},expression:"formTxCOS.cdnHost"}})],1),t("el-form-item",{attrs:{label:"存储路径"}},[t("el-input",{attrs:{placeholder:"如：img，可不填，默认根目录"},model:{value:e.formTxCOS.path,callback:function(t){e.$set(e.formTxCOS,"path","string"===typeof t?t.trim():t)},expression:"formTxCOS.path"}}),t("el-link",{attrs:{type:"primary",href:"https://cloud.tencent.com/document/product/436/38484",target:"_blank"}},[e._v("如何使用腾讯云 COS？ ")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.saveTxCOSConfiguration}},[e._v(" 保存配置 ")])],1)],1)],1),t("el-tab-pane",{staticClass:"github-panel",attrs:{label:"七牛云 Kodo",name:"qiniu"}},[t("el-form",{staticClass:"setting-form",attrs:{model:e.formQiniu,"label-position":"right","label-width":"140px"}},[t("el-form-item",{attrs:{label:"AccessKey",required:!0}},[t("el-input",{attrs:{placeholder:"如：6DD3VaLJ_SQgOjpzyTV_YWaDmdnL2n8EGx7kG"},model:{value:e.formQiniu.accessKey,callback:function(t){e.$set(e.formQiniu,"accessKey","string"===typeof t?t.trim():t)},expression:"formQiniu.accessKey"}})],1),t("el-form-item",{attrs:{label:"SecretKey",required:!0}},[t("el-input",{attrs:{"show-password":"",placeholder:"如：qgZa5qrvjpzmdKStD1oCjZ9nB7MDvJUs_34SIm"},model:{value:e.formQiniu.secretKey,callback:function(t){e.$set(e.formQiniu,"secretKey","string"===typeof t?t.trim():t)},expression:"formQiniu.secretKey"}})],1),t("el-form-item",{attrs:{label:"Bucket",required:!0}},[t("el-input",{attrs:{placeholder:"如：md"},model:{value:e.formQiniu.bucket,callback:function(t){e.$set(e.formQiniu,"bucket","string"===typeof t?t.trim():t)},expression:"formQiniu.bucket"}})],1),t("el-form-item",{attrs:{label:"Bucket 对应域名",required:!0}},[t("el-input",{attrs:{placeholder:"如：https://images.123ylb.cn"},model:{value:e.formQiniu.domain,callback:function(t){e.$set(e.formQiniu,"domain","string"===typeof t?t.trim():t)},expression:"formQiniu.domain"}})],1),t("el-form-item",{attrs:{label:"存储区域",required:!0}},[t("el-input",{attrs:{placeholder:"如：z2"},model:{value:e.formQiniu.region,callback:function(t){e.$set(e.formQiniu,"region","string"===typeof t?t.trim():t)},expression:"formQiniu.region"}})],1),t("el-form-item",{attrs:{label:"存储路径",required:!1}},[t("el-input",{attrs:{placeholder:"如：img，可不填，默认为根目录"},model:{value:e.formQiniu.path,callback:function(t){e.$set(e.formQiniu,"path","string"===typeof t?t.trim():t)},expression:"formQiniu.path"}}),t("el-link",{attrs:{type:"primary",href:"https://developer.qiniu.com/kodo",target:"_blank"}},[e._v("如何使用七牛云 Kodo？ ")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.saveQiniuConfiguration}},[e._v(" 保存配置 ")])],1)],1)],1),t("el-tab-pane",{staticClass:"github-panel",attrs:{label:"MinIO",name:"minio"}},[t("el-form",{staticClass:"setting-form",attrs:{model:e.minioOSS,"label-position":"right","label-width":"140px"}},[t("el-form-item",{attrs:{label:"Endpoint",required:!0}},[t("el-input",{attrs:{placeholder:"如：play.min.io"},model:{value:e.minioOSS.endpoint,callback:function(t){e.$set(e.minioOSS,"endpoint","string"===typeof t?t.trim():t)},expression:"minioOSS.endpoint"}})],1),t("el-form-item",{attrs:{label:"Port",required:!1}},[t("el-input",{attrs:{type:"number",placeholder:"如：9000，可不填，http 默认为 80，https 默认为 443"},model:{value:e.minioOSS.port,callback:function(t){e.$set(e.minioOSS,"port","string"===typeof t?t.trim():t)},expression:"minioOSS.port"}})],1),t("el-form-item",{attrs:{label:"UseSSL",required:!0}},[t("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:e.minioOSS.useSSL,callback:function(t){e.$set(e.minioOSS,"useSSL",t)},expression:"minioOSS.useSSL"}})],1),t("el-form-item",{attrs:{label:"Bucket",required:!0}},[t("el-input",{attrs:{placeholder:"如：jpz"},model:{value:e.minioOSS.bucket,callback:function(t){e.$set(e.minioOSS,"bucket","string"===typeof t?t.trim():t)},expression:"minioOSS.bucket"}})],1),t("el-form-item",{attrs:{label:"AccessKey",required:!0}},[t("el-input",{attrs:{placeholder:"如：zhangsan"},model:{value:e.minioOSS.accessKey,callback:function(t){e.$set(e.minioOSS,"accessKey","string"===typeof t?t.trim():t)},expression:"minioOSS.accessKey"}})],1),t("el-form-item",{attrs:{label:"SecretKey",required:!0}},[t("el-input",{attrs:{placeholder:"如：asdasdasd"},model:{value:e.minioOSS.secretKey,callback:function(t){e.$set(e.minioOSS,"secretKey","string"===typeof t?t.trim():t)},expression:"minioOSS.secretKey"}}),t("el-link",{attrs:{type:"primary",href:"http://docs.minio.org.cn/docs/master/minio-client-complete-guide",target:"_blank"}},[e._v("如何使用 MinIO？ ")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.saveMinioOSSConfiguration}},[e._v(" 保存配置 ")])],1)],1)],1),t("el-tab-pane",{staticClass:"github-panel formCustom",attrs:{label:"自定义代码",name:"formCustom"}},[t("el-form",{staticClass:"setting-form",attrs:{model:e.formCustom,"label-position":"right"}},[t("el-form-item",{attrs:{label:"",required:!0}},[t("el-input",{ref:"formCustomElInput",staticClass:"formCustomElInput",attrs:{type:"textarea",resize:"none",placeholder:"Your custom code here."},model:{value:e.formCustom.code,callback:function(t){e.$set(e.formCustom,"code",t)},expression:"formCustom.code"}}),t("el-link",{attrs:{type:"primary",href:"https://github.com/jpz/md#自定义上传逻辑",target:"_blank"}},[e._v("参数详情？ ")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.formCustomSave}},[e._v(" 保存配置 ")])],1)],1)],1)],1)],1)},Je=[],Qe={props:{visible:{type:Boolean,default:!1}},data(){return{activeName:"upload",formGitHub:{repo:"",branch:"",accessToken:""},formAliOSS:{accessKeyId:"",accessKeySecret:"",bucket:"",region:"",path:"",cdnHost:""},minioOSS:{endpoint:"",port:"",useSSL:!0,bucket:"",accessKey:"",secretKey:""},formTxCOS:{secretId:"",secretKey:"",bucket:"",region:"",path:"",cdnHost:""},formQiniu:{accessKey:"",secretKey:"",bucket:"",domain:"",region:""},formCustom:{code:localStorage.getItem("formCustomConfig")||H(`\n          const {file, util, okCb, errCb} = CUSTOM_ARG\n          const param = new FormData()\n          param.append('file', file)\n          util.axios.post('${window.location.origin}/upload', param, {\n            headers: { 'Content-Type': 'multipart/form-data' }\n          }).then(res => {\n            okCb(res.url)\n          }).catch(err => {\n            errCb(err)\n          })\n        `).trim(),editor:void 0},options:[{value:"default",label:"默认"},{value:"github",label:"GitHub"},{value:"aliOSS",label:"阿里云"},{value:"txCOS",label:"腾讯云"},{value:"qiniu",label:"七牛云"},{value:"minio",label:"MinIO"},{value:"formCustom",label:"自定义代码"}],imgHost:"default"}},created(){localStorage.getItem("githubConfig")&&(this.formGitHub=JSON.parse(localStorage.getItem("githubConfig"))),localStorage.getItem("aliOSSConfig")&&(this.formAliOSS=JSON.parse(localStorage.getItem("aliOSSConfig"))),localStorage.getItem("minioConfig")&&(this.minioOSS=JSON.parse(localStorage.getItem("minioConfig"))),localStorage.getItem("txCOSConfig")&&(this.formTxCOS=JSON.parse(localStorage.getItem("txCOSConfig"))),localStorage.getItem("imgHost")&&(this.imgHost=localStorage.getItem("imgHost"))},methods:{changeImgHost(){localStorage.setItem("imgHost",this.imgHost),this.$message.success("已成功切换图床")},saveGitHubConfiguration(){if(this.formGitHub.repo&&this.formGitHub.accessToken)localStorage.setItem("githubConfig",JSON.stringify(this.formGitHub)),this.$message.success("保存成功");else{const e=this.formGitHub.repo?"token":"GitHub 仓库";this.$message.error(`参数「${e}」不能为空`)}},saveAliOSSConfiguration(){this.formAliOSS.accessKeyId&&this.formAliOSS.accessKeySecret&&this.formAliOSS.bucket&&this.formAliOSS.region?(localStorage.setItem("aliOSSConfig",JSON.stringify(this.formAliOSS)),this.$message.success("保存成功")):this.$message.error("阿里云 OSS 参数配置不全")},saveMinioOSSConfiguration(){this.minioOSS.endpoint&&this.minioOSS.bucket&&this.minioOSS.accessKey&&this.minioOSS.secretKey?(localStorage.setItem("minioConfig",JSON.stringify(this.minioOSS)),this.$message.success("保存成功")):this.$message.error("MinIO 参数配置不全")},saveTxCOSConfiguration(){this.formTxCOS.secretId&&this.formTxCOS.secretKey&&this.formTxCOS.bucket&&this.formTxCOS.region?(localStorage.setItem("txCOSConfig",JSON.stringify(this.formTxCOS)),this.$message.success("保存成功")):this.$message.error("腾讯云 COS 参数配置不全")},saveQiniuConfiguration(){this.formQiniu.accessKey&&this.formQiniu.secretKey&&this.formQiniu.bucket&&this.formQiniu.domain&&this.formQiniu.region?(localStorage.setItem("qiniuConfig",JSON.stringify(this.formQiniu)),this.$message.success("保存成功")):this.$message.error("七牛云 Kodo 参数配置不全")},formCustomSave(){const e=this.formCustom.editor.getValue();localStorage.setItem("formCustomConfig",e),this.$message.success("保存成功")},beforeImageUpload(e){const t=N(e);if(!t.ok)return this.$message.error(t.msg),!1;let o=localStorage.getItem("imgHost");o=o||"default",localStorage.setItem("imgHost",o);const n=localStorage.getItem(o+"Config"),r="default"==o||n;return!!r||(this.$message.error(`请先配置 ${o} 图床参数`),!1)},uploadImage(e){this.$emit("uploadImage",e.file)}},watch:{activeName:{immediate:!0,handler(e){"formCustom"===e&&this.$nextTick(()=>{const e=this.$refs.formCustomElInput.$el.querySelector("textarea");this.formCustom.editor=this.formCustom.editor||b.a.fromTextArea(e,{mode:"javascript"}),this.formCustom.editor.setValue(this.formCustom.code)})}}},mounted(){}},Xe=Qe,Ye=(o("78b8"),Object(s["a"])(Xe,We,Je,!1,null,"200a3646",null)),Ze=Ye.exports,et=function(){var e=this,t=e._self._c;return t("transition",{attrs:{"enter-active-class":"bounceInRight"}},[t("el-col",{directives:[{name:"show",rawName:"v-show",value:e.showCssEditor,expression:"showCssEditor"}],staticClass:"cssEditor-wrapper",attrs:{span:12}},[t("textarea",{attrs:{id:"cssEditor",type:"textarea",placeholder:"Your custom css here."}})])],1)},tt=[],ot={name:"CssEditor",props:{showCssEditor:{type:Boolean,default:!1}}},nt=ot,rt=(o("8b1f"),Object(s["a"])(nt,et,tt,!1,null,"912bf7ea",null)),it=rt.exports,st=function(){var e=this,t=e._self._c;return e.loading?t("transition",{attrs:{name:"fade"}},[t("div",{staticClass:"loading",class:{loading_night:e.nightMode}},[t("strong",[e._v("致力于让 Markdown 编辑更简单")])])]):e._e()},at=[],lt={name:"RunLoading",data(){return{loading:!0}},mounted(){setTimeout(()=>{this.loading=!1},100)},computed:{...Object(d["c"])({nightMode:({nightMode:e})=>e})}},ct=lt,dt=(o("e418"),Object(s["a"])(ct,st,at,!1,null,"19553015",null)),ut=dt.exports,mt=o("3f5e");o("f9d4");var pt={data(){return{showCssEditor:!1,aboutDialogVisible:!1,dialogUploadImgVisible:!1,insertFormDialogVisible:!1,isCoping:!1,isImgLoading:!1,backLight:!1,timeout:null,changeTimer:null,source:"",mouseLeft:0,mouseTop:0,rightClickMenuVisible:!1}},components:{CssEditor:it,RunLoading:ut,EditorHeader:Ae,AboutDialog:je,InsertFormDialog:Ue,RightClickMenu:Ge,UploadImgDialog:Ze},computed:{...Object(d["c"])({wxRenderer:e=>e.wxRenderer,output:e=>e.output,editor:e=>e.editor,cssEditor:e=>e.cssEditor,currentSize:e=>e.currentSize,currentColor:e=>e.currentColor,nightMode:e=>e.nightMode,codeTheme:e=>e.codeTheme})},created(){this.initEditorState(),this.$nextTick(()=>{this.initEditor(),this.initCssEditor(),this.onEditorRefresh(),this.mdLocalToRemote()})},methods:{mdLocalToRemote(){const e=this,t=this.$refs.codeMirrorWrapper.$el;async function o({list:e}){return new Promise((t,o)=>{const{path:n,file:r}=e.find(e=>e.path.match(/\.md$/)),i=new FileReader;i.readAsText(r,"UTF-8"),i.onload=e=>{t({str:e.target.result,file:r,path:n})}})}async function n({md:t,list:o}){const n=[...t.str.matchAll(/!\[(.*?)\]\((.*?)\)/gm)||[]].filter(e=>e),r=t.path.match(/.+?\//)[0],i=await Promise.all(n.map(t=>new Promise((n,i)=>{let[,,s]=t;s=s.replace(/^.\//,"");const{file:a}=o.find(e=>e.path===`${r}${s}`)||{};e.uploadImage(a,e=>{n({matchStr:s,url:e})})})));i.forEach(e=>{t.str=t.str.replace(`](./${e.matchStr})`,`](${e.url})`).replace(`](${e.matchStr})`,`](${e.url})`)}),e.editor.setValue(t.str),console.log("resList",i,t.str)}async function r(e){const t=[];let o="";try{const n=[e];for(const e of n){o+=e.name+"/";for await(const[,r]of e)"file"===r.kind?t.push({path:o+r.name,file:await r.getFile()}):(t.push({path:o+r.name+"/"}),n.push(r))}}catch(n){console.error(n)}return t}t.ondragover=e=>e.preventDefault(),t.ondrop=async e=>{e.preventDefault();for(const t of e.dataTransfer.items)t.getAsFileSystemHandle().then(async e=>{if("directory"===e.kind){const t=await r(e),i=await o({list:t});n({md:i,list:t})}else{const t=await e.getFile();console.log("file",t)}})}},initEditor(){this.initEditorEntity(),this.editor.on("change",(e,t)=>{this.changeTimer&&clearTimeout(this.changeTimer),this.changeTimer=setTimeout(()=>{this.onEditorRefresh(),P(this.editor,"__editor_content")},300)}),this.editor.on("paste",(e,t)=>{if(t.clipboardData&&t.clipboardData.items&&!this.isImgLoading)for(let o=0,n=t.clipboardData.items.length;o<n;++o){let e=t.clipboardData.items[o];if("file"===e.kind){const t=e.getAsFile(),o=this.beforeUpload(t);if(!o)continue;this.uploadImage(t)}}}),this.editor.on("mousedown",()=>{this.rightClickMenuVisible=!1}),this.editor.on("blur",()=>{
//!影响到右键菜单的点击事件，右键菜单的点击事件在组件内通过mousedown触发
this.rightClickMenuVisible=!1}),this.editor.on("scroll",()=>{this.rightClickMenuVisible=!1})},initCssEditor(){this.initCssEditorEntity(),this.cssEditor.on("keyup",(e,t)=>{(t.keyCode>=65&&t.keyCode<=90||189===t.keyCode)&&e.showHint(t)}),this.cssEditor.on("update",e=>{this.cssChanged(),P(this.cssEditor,"__css_content")})},cssChanged(){let e=R(this.cssEditor.getValue(0)),t=L(this.currentSize.replace("px",""));t=j(e,this.currentColor,t),this.setWxRendererOptions({theme:t}),this.onEditorRefresh()},codeThemeChanged(){let e=this.codeTheme,t=document.getElementById("hljs");if(void 0!=t)t.setAttribute("href",e);else{const t=document.createElement("link");t.setAttribute("type","text/css"),t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),t.setAttribute("id","hljs"),document.head.appendChild(t)}},beforeUpload(e){const t=N(e);if(!t.ok)return this.$message.error(t.msg),!1;let o=localStorage.getItem("imgHost");o=o||"default",localStorage.setItem("imgHost",o);const n=localStorage.getItem(o+"Config"),r="default"==o||n;return!!r||(this.$message.error(`请先配置 ${o} 图床参数`),!1)},uploadImage(e,t){this.isImgLoading=!0,K(e).then(o=>{mt["a"].fileUpload(o,e).then(e=>{console.log(e),t?t(e):this.uploaded(e)}).catch(e=>{this.$message.error(e.message)})}).catch(e=>{this.$message.error(e.message)}),this.isImgLoading=!1},uploaded(e){if(console.log("图片上传之后: ",e),!e)return void this.$message.error("上传图片未知异常");this.dialogUploadImgVisible=!1;const t=this.editor.getCursor(),o=e,n=`![](${o})`;this.editor.replaceSelection(`\n${n}\n`,t),this.$message.success("图片上传成功"),this.onEditorRefresh()},leftAndRightScroll(){const e=e=>{let n,r;clearTimeout(this.timeout),"preview"===e?(n=this.$refs.preview.$el,r=document.getElementsByClassName("CodeMirror-scroll")[0],this.editor.off("scroll",t),this.timeout=setTimeout(()=>{this.editor.on("scroll",t)},300)):"editor"===e&&(n=document.getElementsByClassName("CodeMirror-scroll")[0],r=this.$refs.preview.$el,r.removeEventListener("scroll",o,!1),this.timeout=setTimeout(()=>{r.addEventListener("scroll",o,!1)},300));let i=n.scrollTop/(n.scrollHeight-n.offsetHeight),s=i*(r.scrollHeight-r.offsetHeight);r.scrollTo(0,s)},t=()=>{e("editor")},o=()=>{e("preview")};this.$refs.preview.$el.addEventListener("scroll",o,!1),this.editor.on("scroll",t)},onEditorRefresh(){this.codeThemeChanged(this.codeTheme),this.editorRefresh(),setTimeout(()=>window.PR.prettyPrint(),0)},endCopy(){this.backLight=!1,setTimeout(()=>{this.isCoping=!1},800)},addFormat(e,t=e){const{head:o,anchor:n}=this.editor.doc.sel.ranges[0];let r,i;o.line===n.line?o.ch<n.ch?(r=o,i=n):(r=n,i=o):o.line<n.line?(r=o,i=n):(r=n,i=o);const s=[];let a="";for(const c of this.editor.getValue())"\n"===c?(s.push(a),a=""):a+=c;s.push(a);let l="";for(let c=0;c<s.length;c++){const o=s[c];for(let n=0;n<o.length;n++)c===r.line&&n===r.ch&&(l+=e),c===i.line&&n===i.ch&&(l+=t),l+=o[n];c===i.line&&o.length===i.ch&&(l+=t),l+="\n"}this.editor.setValue(l)},importMD(e){this.editor.setValue(e),this.onEditorRefresh()},downloadEditorContent(){F(this.editor.getValue(0))},exportEditorContent(){this.$nextTick(()=>{U(),document.getElementById("output").innerHTML=this.output})},importMarkdownContent(){let e=document.getElementById("menu"),t=document.createElement("input");t.type="file",t.name="filename",t.accept=".txt,.md",e.appendChild(t),t.onchange=()=>{if(!t.files)return;const e=t.files[0];if(!/\.(txt|TXT|MD|md)$/.test(e.name))return void this.$message.error("不支持的文档格式");const o=new FileReader;o.readAsText(e),o.onload=e=>{let t=e.target.result;t=z(t),t&&(localStorage.setItem("__editor_content",t),this.editor.setValue(t),this.$message.success("文档导入成功"))}},t.click(),e.removeChild(t)},formatContent(){const e=z(this.editor.getValue(0));localStorage.setItem("__editor_content",e),this.editor.setValue(e)},openMenu(e){const t=105,o=this.$el.getBoundingClientRect().left,n=this.$el.offsetWidth,r=n-t,i=e.clientX-o;this.mouseLeft=Math.min(r,i),this.mouseTop=e.clientY+10,this.rightClickMenuVisible=!0},onMenuEvent(e){switch(e){case"resetStyle":this.$refs.header.showResetConfirm=!0;break;case"insertPic":this.dialogUploadImgVisible=!0;break;case"download":this.downloadEditorContent();break;case"export":this.exportEditorContent();break;case"insertTable":this.insertFormDialogVisible=!0;break;case"importMarkdown":this.importMarkdownContent();break;case"formatMarkdown":this.formatContent();break;default:break}},...Object(d["b"])(["initEditorState","initEditorEntity","setWxRendererOptions","editorRefresh","initCssEditorEntity"])},mounted(){setTimeout(()=>{this.leftAndRightScroll(),window.PR.prettyPrint()},300)}},ft=pt,ht=(o("7ced"),o("6240"),o("e3fc"),Object(s["a"])(ft,ee,te,!1,null,"b4e935ba",null)),gt=ht.exports,_t={name:"App",components:{CodemirrorEditor:gt}},bt=_t,Ct=Object(s["a"])(bt,Y,Z,!1,null,"821a8f8c",null),St=Ct.exports;n["default"].use(X["a"]);const yt=[{path:"/",name:"index",component:St}],kt=new X["a"]({mode:"history",base:"/md/",routes:yt});var Ot=kt;n["default"].use(Q.a),n["default"].config.productionTip=!1,c.mpType="app";const vt=new n["default"]({router:Ot,store:W,...c});vt.$mount("#app")},6:function(e,t){},6240:function(e,t,o){"use strict";o("cf02")},"63fe":function(e,t,o){"use strict";o("4ff8")},7:function(e,t){},"78b8":function(e,t,o){"use strict";o("cec4")},"7ced":function(e,t,o){"use strict";o("2aa0")},8:function(e,t){},"81e8":function(e,t,o){},"8b1f":function(e,t,o){"use strict";o("4c2f")},9:function(e,t){},9436:function(e,t,o){},a632:function(e,t,o){},a803:function(e,t,o){"use strict";o("bb8a")},aecf:function(e,t,o){"use strict";o("dded")},bb8a:function(e,t,o){},c8e5:function(e,t,o){},cec4:function(e,t,o){},cf02:function(e,t,o){},da71:function(e,t,o){"use strict";o.d(t,"b",(function(){return n})),o.d(t,"a",(function(){return r}));const n={username:"filess",repoList:Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],e=>"img"+e),branch:"main",accessTokenList:["7715d7ca67b5d3837cfjpzmde8c38421815aa423510af","c411415bf95dbe39625jpzmd5047ba9b7a2a6c9642abe","2821cd8819fa345c053jpzmdca86ac653f8bc20db1f1b","445f0dae46ef1f2a4d6jpzmdc797301e94797b4750a4c","cc1d0c1426d0fd0902bjpzmdd2d7184b14da61b86ec46","b67e9d15cb6f910492fjpzmdac6b44d379c953bb19eff","618c4dc2244ccbbc088jpzmd125d17fd31b7d06a50cf3","a4b581732e1c1507458jpzmdc5b223b27dae5e2e16a55","77904db41aee57ad79bjpzmd760f848201dac9c96fd5e","02f251cb14ac62ab100jpzmdddbfc8527d773f1f04ce1","eb321079a95ba7028d9jpzmde2e84c502dac70de7cf08","22f74fcfb071a961fa2jpzmde28dabc746f0503a15e5d","85124c2bfe7abba0938jpzmd0af7f67918b99d085a5fd","0a561b4d4bbecb2de7ejpzmdd9ba3833d11dbc5e430f5","e8a01491188d8d5a097jpzmd03ede0aad1fe9e3af24e9","36e1f420d7e5bdebd67jpzmd65463562f5f25b20b8377"]},r={username:"filesss",repoList:Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],e=>"img"+e),branch:"main",accessTokenList:["ed5fc9866bd6c2fjpzmddd433f806fd2f399c","5448ffebbbf1151jpzmdc4e337cf814fc8a62","25b05efd2557ca2jpzmd75b5c0835e3395911","11628c7a5aef015jpzmd2eeff9fb9566f0458","cb2f5145ed938dejpzmdbd063b4ed244eecf8","d8c0b57500672c1jpzmd55f48b866b5ebcd98","78c56eadb88e453jpzmd43ddd95753351771a","03e1a688003948fjpzmda16fcf41e6f03f1f0","c49121cf4d191fbjpzmdd6a7877ed537e474a","adfeb2fadcdc4aajpzmdfe1ee869ac9c968ff","116c94549ca4a0djpzmd192653af5c0694616","ecf30ed7f2eb184jpzmd51ea4ec8300371d9e","5837cf2bd5afd93jpzmd73904bed31934949e","b5b7e1c7d57e01fjpzmd5266f552574297d78","684d55564ffbd0bjpzmd7d747e5cc23aed6d6","3fc04a9d272ab71jpzmd010c56cb57d88d2ba"]}},dded:function(e,t,o){},e1d2:function(e,t,o){"use strict";var n=o("bc3a"),r=o.n(n);const i=r.a.create({baseURL:"",timeout:3e4});i.interceptors.request.use(e=>(/^(post)|(put)|(delete)$/i.test(e.method)&&e.data&&e.data.upload&&(e.headers["Content-Type"]="multipart/form-data"),e),e=>{Promise.reject(e)}),i.interceptors.response.use(e=>e.data?e.data:Promise.reject(e),e=>Promise.reject(e)),t["a"]=i},e257:function(e,t,o){},e3fc:function(e,t,o){"use strict";o("5609")},e418:function(e,t,o){"use strict";o("e257")},ebdd:function(e,t,o){"use strict";o("3f50")},f4a0:function(e,t,o){"use strict";o("220e")},f6d9:function(e,t,o){"use strict";o("a632")},fd13:function(e,t,o){"use strict";o("c8e5")}});